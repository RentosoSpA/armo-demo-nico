@use '../base/variables' as v;

.bear-progress-bar {
  position: sticky;
  top: 0;
  z-index: 20;
  padding: 0.5rem 1rem;
  background: transparent;
  height: 56px;
  display: flex;
  align-items: center;

  &__container {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    gap: 0;

    @media (max-width: 768px) {
      justify-content: space-between;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      
      &::-webkit-scrollbar {
        display: none;
      }
    }
  }

  &__trail {
    flex: 1;
    min-width: 40px;
    max-width: 100px;
    height: 2px;
    background: #273046;
    border-radius: 1px;
    transition: background-color 300ms cubic-bezier(0.4, 0, 0.2, 1),
                width 400ms cubic-bezier(0.4, 0, 0.2, 1);

    &--active {
      background: #3DDAD8;
    }

    @media (max-width: 768px) {
      min-width: 20px;
      max-width: 60px;
    }

    @media (prefers-reduced-motion: reduce) {
      transition: none;
    }
  }

  &__paw {
    position: relative;
    width: 32px;
    height: 32px;
    padding: 0;
    border: none;
    background: transparent;
    cursor: pointer;
    transition: transform 200ms cubic-bezier(0.4, 0, 0.2, 1);
    scroll-snap-align: center;

    &:disabled {
      cursor: not-allowed;
    }

    &:not(:disabled):hover {
      transform: scale(1.15);
    }

    @media (prefers-reduced-motion: reduce) {
      transition: none;
      
      &:not(:disabled):hover {
        transform: none;
      }
    }

    // Pending state - outline only with low opacity
    &--pending {
      .bear-progress-bar__paw-icon {
        color: #475569;
        opacity: 0.6;
        fill: none;
        stroke: currentColor;
        stroke-width: 1px;
      }
    }

    // Completed state - filled
    &--completed {
      .bear-progress-bar__paw-icon {
        color: #3DDAD8;
        opacity: 1;
      }
    }

    // Current state - larger with glow and pulse
    &--current {
      transform: scale(1.1);
      
      .bear-progress-bar__paw-icon {
        color: #3DDAD8;
        opacity: 1;
        filter: drop-shadow(0 0 8px rgba(61, 218, 216, 0.6))
                drop-shadow(0 0 12px rgba(61, 218, 216, 0.4));
        animation: bearPawPulse 2s ease-in-out infinite;
      }

      // Glass border effect
      &::before {
        content: '';
        position: absolute;
        inset: -4px;
        border-radius: 50%;
        border: 2px solid rgba(61, 218, 216, 0.3);
        background: rgba(61, 218, 216, 0.05);
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        pointer-events: none;
      }

      @media (prefers-reduced-motion: reduce) {
        .bear-progress-bar__paw-icon {
          animation: none;
        }
      }
    }

    &-icon {
      width: 100%;
      height: 100%;
      transition: color 200ms ease, filter 200ms ease;
    }
  }
}

@keyframes bearPawPulse {
  0%, 100% {
    filter: drop-shadow(0 0 8px rgba(61, 218, 216, 0.6))
            drop-shadow(0 0 12px rgba(61, 218, 216, 0.4));
  }
  50% {
    filter: drop-shadow(0 0 12px rgba(61, 218, 216, 0.8))
            drop-shadow(0 0 16px rgba(61, 218, 216, 0.6));
  }
}

// Micro-bounce animation when advancing steps
@keyframes bearPawBounce {
  0%, 100% {
    transform: scale(1.1);
  }
  50% {
    transform: scale(1.2);
  }
}

.bear-progress-bar__paw--current {
  animation: bearPawBounce 600ms cubic-bezier(0.4, 0, 0.2, 1);
  
  @media (prefers-reduced-motion: reduce) {
    animation: none;
  }
}

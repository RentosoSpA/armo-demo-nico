import{c as k,x as A,y as B,z as L,p as D,e as M,E as $,r as d,o as y,j as a,g as T,B as p,G as R,H as z,J as C,R as U,C as t,U as V,M as F,K as O}from"./index-BmXdxNCh.js";import{B as G,a as H}from"./bed-Bj-CoIoH.js";import{C as q}from"./circle-check-BDmSzWpF.js";import{P as J}from"./phone-DAwCiXjk.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],P=k("ruler",K);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],W=k("share-2",Z),Q=async l=>{await A();const r=B.propiedades.find(e=>e.id===l);if(!r||!r.imagenPrincipal)return{files:[],signedUrl:null};const c=L(r.imagenPrincipal)||r.imagenPrincipal;return{files:[{id:`${l}-img-principal`,propiedad_id:l,url:c,nombre_archivo:r.imagenPrincipal,tipo_imagen:"principal",orden:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),descripcion:null}],signedUrl:c}},sa=()=>{var b,f;const{id:l}=D(),r=M(),{fetchPropiedadById:c,loading:x}=$(),[e,w]=d.useState(null),[m,j]=d.useState(null),[u,S]=d.useState(0),_=async()=>{if(navigator.share&&e)try{await navigator.share({title:e.titulo,text:`Mira esta propiedad: ${e.titulo}`,url:window.location.href})}catch{console.log("Share cancelled")}else navigator.clipboard.writeText(window.location.href),y.success("✓ Enlace copiado al portapapeles")},h=s=>({Disponible:{color:"#10b981",bg:"rgba(16, 185, 129, 0.1)"},Reservada:{color:"#f59e0b",bg:"rgba(245, 158, 11, 0.1)"},Vendida:{color:"#3b82f6",bg:"rgba(59, 130, 246, 0.1)"},Arrendada:{color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.1)"}})[s]||{color:"#6b7280",bg:"rgba(107, 114, 128, 0.1)"},E=(s,i="CLP")=>`${s.toLocaleString("es-CL")} ${i}`,o=((b=m==null?void 0:m.files)==null?void 0:b.map(s=>s.url))||[],v=o[u]||(e==null?void 0:e.imagenPrincipal),g=s=>{if(!s)return[];const i={amoblado:"Amoblado",cocina:"Cocina equipada",mascota:"Acepta mascotas",estacionamiento:"Estacionamiento",balcon:"Balcón",jardin:"Jardín",wifi:"WiFi",garage:"Garaje",zonaFumador:"Zona fumador",lavaplatos:"Lavaplatos",lavadora:"Lavadora",tvCable:"TV Cable",enCondominio:"En condominio",permiteMascotas:"Permite mascotas",piscina:"Piscina",gimnasio:"Gimnasio",sauna:"Sauna",jacuzzi:"Jacuzzi",bodega:"Bodega",piezaServicio:"Pieza de servicio",agua:"Agua",caldera:"Caldera",gasNatural:"Gas natural",luz:"Luz",alcantarillado:"Alcantarillado"};return Object.entries(s).filter(([n,I])=>I===!0&&n!=="id"&&n!=="propiedadId").map(([n])=>i[n]||n)},N=d.useCallback(async()=>{if(l)try{const s=await c(l);w(s);try{const i=await Q(l);j(i)}catch(i){console.warn("No se pudieron cargar imágenes adicionales:",i),j({files:[]})}}catch(s){console.error("Error fetching propiedad:",s),y.error("Propiedad no encontrada"),r("/404")}},[l,r,c]);return d.useEffect(()=>{l&&N()},[l,N]),x?a.jsx("div",{className:"d-flex align-center justify-center",style:{minHeight:"400px"},children:a.jsx(T,{size:"large"})}):e?a.jsxs("div",{className:"propiedad-ficha-portal",children:[a.jsx("div",{className:"portal-back-nav",children:a.jsx(p,{type:"text",icon:a.jsx(R,{size:18}),onClick:()=>r("/propiedades"),className:"portal-back-btn",children:"Volver a propiedades"})}),a.jsxs("div",{className:"portal-hero-section",children:[a.jsxs("div",{className:"portal-hero-main-image",children:[v?a.jsx("img",{src:v,alt:e.titulo}):a.jsx("div",{className:"portal-hero-placeholder",children:a.jsx(z,{size:64})}),a.jsx("div",{className:"portal-estado-badge",style:{background:h(e.estado).bg,borderColor:h(e.estado).color,color:h(e.estado).color},children:e.estado})]}),o.length>1&&a.jsx("div",{className:"portal-thumbnails",children:o.slice(0,5).map((s,i)=>a.jsxs("div",{className:`portal-thumbnail ${i===u?"active":""}`,onClick:()=>S(i),children:[a.jsx("img",{src:s,alt:`Vista ${i+1}`}),i===4&&o.length>5&&a.jsxs("div",{className:"portal-thumbnail-overlay",children:["+",o.length-5]})]},i))})]}),a.jsxs("div",{className:"portal-content-wrapper",children:[a.jsxs("div",{className:"portal-left-column",children:[a.jsxs("div",{className:"portal-title-section",children:[a.jsxs("div",{className:"portal-title-row",children:[a.jsx("h1",{className:"portal-title",children:e.titulo}),a.jsx(p,{type:"text",icon:a.jsx(W,{size:20}),onClick:_,className:"portal-share-btn"})]}),a.jsxs("div",{className:"portal-location",children:[a.jsx(C,{size:16}),a.jsx("span",{children:e.direccion})]}),a.jsxs("div",{className:"portal-price-section",children:[a.jsx("div",{className:"portal-price-main",children:E(e.precio||e.precioVenta||((f=e.propiedadVenta)==null?void 0:f.precioPrincipal)||0,e.divisa||"CLP")}),a.jsx("div",{className:"portal-operation-badge",children:e.operacion})]})]}),a.jsxs("div",{className:"portal-features-grid",children:[e.habitaciones&&a.jsxs("div",{className:"portal-feature-card",children:[a.jsx(G,{size:24}),a.jsxs("div",{children:[a.jsx("div",{className:"portal-feature-value",children:e.habitaciones}),a.jsx("div",{className:"portal-feature-label",children:"Dormitorios"})]})]}),e.banos&&a.jsxs("div",{className:"portal-feature-card",children:[a.jsx(H,{size:24}),a.jsxs("div",{children:[a.jsx("div",{className:"portal-feature-value",children:e.banos}),a.jsx("div",{className:"portal-feature-label",children:"Baños"})]})]}),(e.superficie_total||e.areaTotal)&&a.jsxs("div",{className:"portal-feature-card",children:[a.jsx(P,{size:24}),a.jsxs("div",{children:[a.jsxs("div",{className:"portal-feature-value",children:[e.superficie_total||e.areaTotal,"m²"]}),a.jsx("div",{className:"portal-feature-label",children:"Superficie Total"})]})]}),e.superficie_util&&a.jsxs("div",{className:"portal-feature-card",children:[a.jsx(P,{size:24}),a.jsxs("div",{children:[a.jsxs("div",{className:"portal-feature-value",children:[e.superficie_util,"m²"]}),a.jsx("div",{className:"portal-feature-label",children:"Superficie Útil"})]})]})]}),a.jsxs("div",{className:"portal-section-card",children:[a.jsx("h2",{className:"portal-section-title",children:"Descripción"}),a.jsx("p",{className:"portal-description",children:e.descripcion||"Hermosa propiedad disponible. Contáctanos para más información."})]}),a.jsxs("div",{className:"portal-section-card",children:[a.jsx("h2",{className:"portal-section-title",children:"Características"}),a.jsxs(U,{gutter:[16,16],children:[a.jsx(t,{span:12,children:a.jsxs("div",{className:"portal-detail-item",children:[a.jsx("span",{className:"portal-detail-label",children:"Tipo:"}),a.jsx("span",{className:"portal-detail-value",children:e.tipo})]})}),a.jsx(t,{span:12,children:a.jsxs("div",{className:"portal-detail-item",children:[a.jsx("span",{className:"portal-detail-label",children:"Operación:"}),a.jsx("span",{className:"portal-detail-value",children:e.operacion})]})}),e.habitaciones&&a.jsx(t,{span:12,children:a.jsxs("div",{className:"portal-detail-item",children:[a.jsx("span",{className:"portal-detail-label",children:"Dormitorios:"}),a.jsx("span",{className:"portal-detail-value",children:e.habitaciones})]})}),e.banos&&a.jsx(t,{span:12,children:a.jsxs("div",{className:"portal-detail-item",children:[a.jsx("span",{className:"portal-detail-label",children:"Baños:"}),a.jsx("span",{className:"portal-detail-value",children:e.banos})]})}),e.estacionamientos&&a.jsx(t,{span:12,children:a.jsxs("div",{className:"portal-detail-item",children:[a.jsx("span",{className:"portal-detail-label",children:"Estacionamientos:"}),a.jsx("span",{className:"portal-detail-value",children:e.estacionamientos})]})}),e.bodegas&&a.jsx(t,{span:12,children:a.jsxs("div",{className:"portal-detail-item",children:[a.jsx("span",{className:"portal-detail-label",children:"Bodegas:"}),a.jsx("span",{className:"portal-detail-value",children:e.bodegas})]})})]})]}),e.amenidades&&g(e.amenidades).length>0&&a.jsxs("div",{className:"portal-section-card",children:[a.jsx("h2",{className:"portal-section-title",children:"Amenidades"}),a.jsx("div",{className:"portal-amenities-grid",children:g(e.amenidades).map((s,i)=>a.jsxs("div",{className:"portal-amenity-item",children:[a.jsx(q,{size:18}),a.jsx("span",{children:s})]},i))})]}),a.jsxs("div",{className:"portal-section-card",children:[a.jsx("h2",{className:"portal-section-title",children:"Ubicación"}),a.jsxs("div",{className:"portal-location-details",children:[a.jsx("div",{className:"portal-location-icon",children:a.jsx(C,{size:24})}),a.jsxs("div",{children:[a.jsx("div",{className:"portal-location-address",children:e.direccion}),e.comuna&&a.jsxs("div",{className:"portal-location-meta",children:["Comuna: ",e.comuna]}),e.region&&a.jsxs("div",{className:"portal-location-meta",children:["Región: ",e.region]})]})]})]})]}),a.jsx("div",{className:"portal-right-column",children:a.jsxs("div",{className:"portal-contact-card",children:[a.jsx("h3",{className:"portal-contact-title",children:"¿Interesado en esta propiedad?"}),a.jsx("p",{className:"portal-contact-subtitle",children:"Contáctanos para más información"}),e.propietario&&a.jsxs("div",{className:"portal-agent-info",children:[a.jsx("div",{className:"portal-agent-icon",children:a.jsx(V,{size:24})}),a.jsxs("div",{children:[a.jsx("div",{className:"portal-agent-label",children:"Propietario"}),a.jsx("div",{className:"portal-agent-name",children:e.propietario.nombre})]})]}),a.jsxs("div",{className:"portal-contact-buttons",children:[a.jsx(p,{type:"primary",size:"large",icon:a.jsx(J,{size:18}),block:!0,className:"portal-contact-btn-primary",children:"Llamar ahora"}),a.jsx(p,{size:"large",icon:a.jsx(F,{size:18}),block:!0,className:"portal-contact-btn-secondary",children:"Enviar mensaje"})]}),a.jsxs("div",{className:"portal-property-meta",children:[a.jsxs("div",{className:"portal-meta-item",children:[a.jsx(O,{size:16}),a.jsx("span",{children:"Publicado hace 2 días"})]}),a.jsxs("div",{className:"portal-meta-item",children:[a.jsx(z,{size:16}),a.jsxs("span",{children:["ID: ",e.id.slice(0,8)]})]})]}),a.jsx(p,{type:"default",block:!0,onClick:()=>r(`/propiedades/editar/${e.id}`),className:"portal-edit-btn",children:"Editar Propiedad"})]})})]})]}):null};export{sa as default};

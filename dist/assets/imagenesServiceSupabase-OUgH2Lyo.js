import{c as p,s as e}from"./index-BmXdxNCh.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u=[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]],f=p("tree-pine",u),c="property-images",w=async(o,r,a="galeria")=>{try{const t=r.name.split(".").pop(),g=`${Date.now()}-${Math.random().toString(36).substring(7)}.${t}`,n=`${o}/${g}`,{error:d}=await e.storage.from(c).upload(n,r,{cacheControl:"3600",upsert:!1});if(d)throw d;const{data:l}=e.storage.from(c).getPublicUrl(n),{data:s}=await e.from("propiedad_imagenes").select("orden").eq("propiedad_id",o).order("orden",{ascending:!1}).limit(1),m=s&&s.length>0?(s[0].orden||0)+1:1,{error:i}=await e.from("propiedad_imagenes").insert([{propiedad_id:o,url:l.publicUrl,nombre_archivo:r.name,tipo_imagen:a,orden:m}]);if(i)throw console.error("Error saving image record:",i),await e.storage.from(c).remove([n]),i;return l.publicUrl}catch(t){throw console.error("Error uploading image:",t),t}},_=async o=>{try{const{data:r,error:a}=await e.from("propiedad_imagenes").select("*").eq("propiedad_id",o).order("orden",{ascending:!0});if(a)throw a;return{files:r||[],signedUrl:r&&r.length>0?r[0].url:null}}catch(r){throw console.error("Error fetching images:",r),r}};export{f as T,_ as g,w as u};

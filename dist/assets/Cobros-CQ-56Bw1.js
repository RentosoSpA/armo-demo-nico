import{r as g,bh as oe,S as V,bi as ze,bj as ne,V as Re,W as De,bk as Be,Y as N,bl as Ie,X as Oe,bm as ke,_ as Ye,ai as se,Q as X,aZ as Fe,bn as Ve,bo as Le,bp as He,j as e,R as Z,T as L,aJ as We,B as R,bq as Xe,br as _e,bs as qe,C as E,b9 as Ue,z as re,a3 as _,bb as Ge,bt as ie,a as U,bu as Ze,bv as Je,bg as le,b8 as Ke,d as ce,x as J,y as Qe,aE as K,b6 as ea,f as aa,k as ta,bw as oa,bx as na}from"./index-BmXdxNCh.js";import{c as I,f as de}from"./formatters-BB-XqqfA.js";const sa=10,ra=20;function ia(a){const{fullscreen:t,validRange:o,generateConfig:r,locale:d,prefixCls:s,value:l,onChange:p,divRef:h}=a,x=r.getYear(l||r.getNow());let b=x-sa,i=b+ra;o&&(b=r.getYear(o[0]),i=r.getYear(o[1])+1);const c=d&&d.year==="å¹´"?"å¹´":"",y=[];for(let f=b;f<i;f++)y.push({label:`${f}${c}`,value:f});return g.createElement(V,{size:t?void 0:"small",options:y,value:x,className:`${s}-year-select`,onChange:f=>{let n=r.setYear(l,f);if(o){const[m,C]=o,S=r.getYear(n),j=r.getMonth(n);S===r.getYear(C)&&j>r.getMonth(C)&&(n=r.setMonth(n,r.getMonth(C))),S===r.getYear(m)&&j<r.getMonth(m)&&(n=r.setMonth(n,r.getMonth(m)))}p(n)},getPopupContainer:()=>h.current})}function la(a){const{prefixCls:t,fullscreen:o,validRange:r,value:d,generateConfig:s,locale:l,onChange:p,divRef:h}=a,x=s.getMonth(d||s.getNow());let b=0,i=11;if(r){const[f,n]=r,m=s.getYear(d);s.getYear(n)===m&&(i=s.getMonth(n)),s.getYear(f)===m&&(b=s.getMonth(f))}const c=l.shortMonths||s.locale.getShortMonths(l.locale),y=[];for(let f=b;f<=i;f+=1)y.push({label:c[f],value:f});return g.createElement(V,{size:o?void 0:"small",className:`${t}-month-select`,value:x,options:y,onChange:f=>{p(s.setMonth(d,f))},getPopupContainer:()=>h.current})}function ca(a){const{prefixCls:t,locale:o,mode:r,fullscreen:d,onModeChange:s}=a;return g.createElement(ze,{onChange:({target:{value:l}})=>{s(l)},value:r,size:d?void 0:"small",className:`${t}-mode-switch`},g.createElement(ne,{value:"month"},o.month),g.createElement(ne,{value:"year"},o.year))}function da(a){const{prefixCls:t,fullscreen:o,mode:r,onChange:d,onModeChange:s}=a,l=g.useRef(null),p=g.useContext(oe),h=g.useMemo(()=>Object.assign(Object.assign({},p),{isFormItemInput:!1}),[p]),x=Object.assign(Object.assign({},a),{fullscreen:o,divRef:l});return g.createElement("div",{className:`${t}-header`,ref:l},g.createElement(oe.Provider,{value:h},g.createElement(ia,Object.assign({},x,{onChange:b=>{d(b,"year")}})),r==="month"&&g.createElement(la,Object.assign({},x,{onChange:b=>{d(b,"month")}}))),g.createElement(ca,Object.assign({},x,{onModeChange:s})))}const ma=a=>{const{calendarCls:t,componentCls:o,fullBg:r,fullPanelBg:d,itemActiveBg:s}=a;return{[t]:Object.assign(Object.assign(Object.assign({},Ie(a)),Oe(a)),{background:r,"&-rtl":{direction:"rtl"},[`${t}-header`]:{display:"flex",justifyContent:"flex-end",padding:`${N(a.paddingSM)} 0`,[`${t}-year-select`]:{minWidth:a.yearControlWidth},[`${t}-month-select`]:{minWidth:a.monthControlWidth,marginInlineStart:a.marginXS},[`${t}-mode-switch`]:{marginInlineStart:a.marginXS}}}),[`${t} ${o}-panel`]:{background:d,border:0,borderTop:`${N(a.lineWidth)} ${a.lineType} ${a.colorSplit}`,borderRadius:0,[`${o}-month-panel, ${o}-date-panel`]:{width:"auto"},[`${o}-body`]:{padding:`${N(a.paddingXS)} 0`},[`${o}-content`]:{width:"100%"}},[`${t}-mini`]:{borderRadius:a.borderRadiusLG,[`${t}-header`]:{paddingInlineEnd:a.paddingXS,paddingInlineStart:a.paddingXS},[`${o}-panel`]:{borderRadius:`0 0 ${N(a.borderRadiusLG)} ${N(a.borderRadiusLG)}`},[`${o}-content`]:{height:a.miniContentHeight,th:{height:"auto",padding:0,lineHeight:N(a.weekHeight)}},[`${o}-cell::before`]:{pointerEvents:"none"}},[`${t}${t}-full`]:{[`${o}-panel`]:{display:"block",width:"100%",textAlign:"end",background:r,border:0,[`${o}-body`]:{"th, td":{padding:0},th:{height:"auto",paddingInlineEnd:a.paddingSM,paddingBottom:a.paddingXXS,lineHeight:N(a.weekHeight)}}},[`${o}-cell-week ${o}-cell-inner`]:{display:"block",borderRadius:0,borderTop:`${N(a.lineWidthBold)} ${a.lineType} ${a.colorSplit}`,width:"100%",height:a.calc(a.dateValueHeight).add(a.dateContentHeight).add(a.calc(a.paddingXS).div(2)).add(a.lineWidthBold).equal()},[`${o}-cell`]:{"&::before":{display:"none"},"&:hover":{[`${t}-date`]:{background:a.controlItemBgHover}},[`${t}-date-today::before`]:{display:"none"},[`&-in-view${o}-cell-selected`]:{[`${t}-date, ${t}-date-today`]:{background:s}},"&-selected, &-selected:hover":{[`${t}-date, ${t}-date-today`]:{[`${t}-date-value`]:{color:a.colorPrimary}}}},[`${t}-date`]:{display:"block",width:"auto",height:"auto",margin:`0 ${N(a.calc(a.marginXS).div(2).equal())}`,padding:`${N(a.calc(a.paddingXS).div(2).equal())} ${N(a.paddingXS)} 0`,border:0,borderTop:`${N(a.lineWidthBold)} ${a.lineType} ${a.colorSplit}`,borderRadius:0,transition:`background ${a.motionDurationSlow}`,"&-value":{lineHeight:N(a.dateValueHeight),transition:`color ${a.motionDurationSlow}`},"&-content":{position:"static",width:"auto",height:a.dateContentHeight,overflowY:"auto",color:a.colorText,lineHeight:a.lineHeight,textAlign:"start"},"&-today":{borderColor:a.colorPrimary,[`${t}-date-value`]:{color:a.colorText}}}},[`@media only screen and (max-width: ${N(a.screenXS)}) `]:{[t]:{[`${t}-header`]:{display:"block",[`${t}-year-select`]:{width:"50%"},[`${t}-month-select`]:{width:`calc(50% - ${N(a.paddingXS)})`},[`${t}-mode-switch`]:{width:"100%",marginTop:a.marginXS,marginInlineStart:0,"> label":{width:"50%",textAlign:"center"}}}}}}},ua=a=>Object.assign({fullBg:a.colorBgContainer,fullPanelBg:a.colorBgContainer,itemActiveBg:a.controlItemBgActive,yearControlWidth:80,monthControlWidth:70,miniContentHeight:256},ke(a)),ga=Re("Calendar",a=>{const t=`${a.componentCls}-calendar`,o=De(a,Be(a),{calendarCls:t,pickerCellInnerCls:`${a.componentCls}-cell-inner`,dateValueHeight:a.controlHeightSM,weekHeight:a.calc(a.controlHeightSM).mul(.75).equal(),dateContentHeight:a.calc(a.calc(a.fontHeightSM).add(a.marginXS)).mul(3).add(a.calc(a.lineWidth).mul(2)).equal()});return ma(o)},ua),he=(a,t,o)=>{const{getYear:r}=o;return a&&t&&r(a)===r(t)},G=(a,t,o)=>{const{getMonth:r}=o;return he(a,t,o)&&r(a)===r(t)},me=(a,t,o)=>{const{getDate:r}=o;return G(a,t,o)&&r(a)===r(t)},pe=a=>o=>{const{prefixCls:r,className:d,rootClassName:s,style:l,dateFullCellRender:p,dateCellRender:h,monthFullCellRender:x,monthCellRender:b,cellRender:i,fullCellRender:c,headerRender:y,value:f,defaultValue:n,disabledDate:m,mode:C,validRange:S,fullscreen:j=!0,showWeek:D,onChange:O,onPanelChange:v,onSelect:M}=o,{getPrefixCls:H,direction:be,className:xe,style:Ce}=Ye("calendar"),k=H("picker",r),$=`${k}-calendar`,[ve,je,ye]=ga(k,$),ee=a.getNow(),[B,Se]=se(()=>f||a.getNow(),{defaultValue:n,value:f}),[Y,we]=se("month",{value:C}),F=g.useMemo(()=>Y==="year"?"month":"date",[Y]),Pe=g.useCallback(u=>(S?a.isAfter(S[0],u)||a.isAfter(u,S[1]):!1)||!!(m!=null&&m(u)),[m,S]),ae=(u,w)=>{v==null||v(u,w)},Ne=u=>{Se(u),me(u,B,a)||((F==="date"&&!G(u,B,a)||F==="month"&&!he(u,B,a))&&ae(u,Y),O==null||O(u))},te=u=>{we(u),ae(B,u)},W=(u,w)=>{Ne(u),M==null||M(u,{source:w})},$e=g.useCallback((u,w)=>c?c(u,w):p?p(u):g.createElement("div",{className:X(`${k}-cell-inner`,`${$}-date`,{[`${$}-date-today`]:me(ee,u,a)})},g.createElement("div",{className:`${$}-date-value`},String(a.getDate(u)).padStart(2,"0")),g.createElement("div",{className:`${$}-date-content`},i?i(u,w):h==null?void 0:h(u))),[p,h,i,c]),Me=g.useCallback((u,w)=>{if(c)return c(u,w);if(x)return x(u);const Te=w.locale.shortMonths||a.locale.getShortMonths(w.locale.locale);return g.createElement("div",{className:X(`${k}-cell-inner`,`${$}-date`,{[`${$}-date-today`]:G(ee,u,a)})},g.createElement("div",{className:`${$}-date-value`},Te[a.getMonth(u)]),g.createElement("div",{className:`${$}-date-content`},i?i(u,w):b==null?void 0:b(u)))},[x,b,i,c]),[Ae]=Fe("Calendar",Ve),A=Object.assign(Object.assign({},Ae),o.locale),Ee=(u,w)=>{if(w.type==="date")return $e(u,w);if(w.type==="month")return Me(u,Object.assign(Object.assign({},w),{locale:A==null?void 0:A.lang}))};return ve(g.createElement("div",{className:X($,{[`${$}-full`]:j,[`${$}-mini`]:!j,[`${$}-rtl`]:be==="rtl"},xe,d,s,je,ye),style:Object.assign(Object.assign({},Ce),l)},y?y({value:B,type:Y,onChange:u=>{W(u,"customize")},onTypeChange:te}):g.createElement(da,{prefixCls:$,value:B,generateConfig:a,mode:Y,fullscreen:j,locale:A==null?void 0:A.lang,validRange:S,onChange:W,onModeChange:te}),g.createElement(Le,{value:B,prefixCls:k,locale:A==null?void 0:A.lang,generateConfig:a,cellRender:Ee,onSelect:u=>{W(u,F)},mode:F,picker:F,disabledDate:Pe,hideHeader:!0,showWeek:D})))},fe=pe(He);fe.generateCalendar=pe;const{Title:ha}=L,pa=({setBusqueda:a,onNuevoCobro:t,showNotifications:o,onNotificationsClick:r})=>e.jsxs("div",{className:"d-flex align-center justify-between mb-24",children:[e.jsx(Z,{justify:"space-between",align:"middle",className:"mb-24",children:e.jsxs("div",{children:[e.jsx(ha,{level:2,className:"title-text mb-0",children:"Cobros"}),e.jsx("div",{className:"paragraph-text paragraph-secondary mb-8",children:"Gestiona los cobros y pagos de propiedades."})]})}),e.jsxs("div",{className:"d-flex align-center gap-16",children:[e.jsx(We,{placeholder:"Buscar cobros...",onSearch:a,style:{width:300}}),e.jsx(R,{icon:e.jsx(Xe,{size:20}),onClick:r,style:{background:o?"#33F491":"transparent",color:o?"#222222":"#ffffff",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px"},children:"Notificaciones"}),e.jsx(_e,{variant:"primary",icon:qe,onClick:t,style:{background:"transparent",border:"2px solid #33F491",color:"#33F491"},className:"nuevo-cobro-btn",children:"Nuevo Cobro"})]})]}),q=({bear:a,caption:t,value:o,label:r,icon:d,onClick:s,loading:l=!1})=>{const p={curioso:"var(--color-bear-curioso)",cauteloso:"var(--color-bear-cauteloso)",notarioso:"var(--color-bear-notarioso)",cuidadoso:"var(--color-bear-cuidadoso)",armonioso:"var(--color-primary)"};return e.jsxs("div",{className:`bear-stat-card ${a} ${s?"clickable":""}`,onClick:s,style:{"--bear-color":p[a]},children:[e.jsx("div",{className:"bear-stat-icon",children:d||e.jsx("span",{children:"ðŸ»"})}),e.jsxs("div",{className:"bear-stat-content",children:[e.jsx("div",{className:"bear-stat-caption",children:t}),e.jsx("div",{className:"bear-stat-value",children:l?"...":o}),e.jsx("div",{className:"bear-stat-label",children:r})]})]})},fa=({stats:a,loading:t})=>e.jsxs(Z,{gutter:[24,24],className:"mt-24",children:[e.jsx(E,{xs:24,md:12,xl:8,children:e.jsx(q,{bear:"cuidadoso",caption:"Oso Cuidadoso ha identificado",value:a.pendientesCobrar,label:"PENDIENTES POR COBRAR",loading:t})}),e.jsx(E,{xs:24,md:12,xl:8,children:e.jsx(q,{bear:"cuidadoso",caption:"Oso Cuidadoso ha detectado",value:a.atrasados,label:"ATRASADOS",loading:t})}),e.jsx(E,{xs:24,md:12,xl:8,children:e.jsx(q,{bear:"cuidadoso",caption:"Oso Cuidadoso ha gestionado",value:a.cobradosExito,label:"COBRADOS CON Ã‰XITO",loading:t})})]}),{Text:P}=L,ba=({data:a,loading:t,onCobroClick:o,onEstadoChange:r})=>{const[d,s]=g.useState(null),[l,p]=g.useState({}),[h,x]=g.useState({}),b=n=>{switch(n){case"Pagado":return"success";case"Por cobrar":return"processing";case"Atrasado":return"error";case"Cobrado parcialmente":return"warning";default:return"default"}},i=[{label:"Por cobrar",value:"Por cobrar"},{label:"Pagado",value:"Pagado"},{label:"Atrasado",value:"Atrasado"},{label:"Cobrado parcialmente",value:"Cobrado parcialmente"}],c=(n,m)=>{r==null||r(n,m),s(null)},y=[{title:"Imagen",dataIndex:"propiedad",render:(n,m)=>{const C=re(n.imagenUrl);return e.jsx("div",{className:"cobro-image-container",style:{width:80,height:80,minWidth:80,minHeight:80},children:!h[m.id]&&C?e.jsxs(e.Fragment,{children:[!l[m.id]&&e.jsx("div",{className:"cobro-image-shimmer"}),e.jsx("img",{src:C,alt:n.titulo,className:`cobro-image ${l[m.id]?"loaded":""}`,onLoad:()=>p(S=>({...S,[m.id]:!0})),onError:()=>x(S=>({...S,[m.id]:!0}))})]}):e.jsx("div",{className:"cobro-image-fallback"})})},width:100},{title:"Propiedad",dataIndex:"propiedad",render:n=>e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-4",style:{color:"#ffffff"},children:n.titulo}),e.jsxs("div",{className:"mb-4",style:{color:"#ffffff"},children:["ðŸ“ ",n.direccion]}),e.jsx("div",{className:"text-12",children:e.jsx(_,{color:"blue",className:"m-0",children:n.operacion})})]}),width:250},{title:"Cliente",dataIndex:"cliente",render:n=>e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-4",style:{color:"#ffffff"},children:n.nombre}),e.jsxs("div",{style:{fontSize:"12px",color:"#ffffff",marginBottom:2},children:["ðŸ“ž ",n.telefono]}),e.jsxs("div",{style:{fontSize:"12px",color:"#ffffff"},children:["âœ‰ï¸ ",n.email]})]}),width:250},{title:"Estado de Pago",dataIndex:"estado",render:(n,m)=>d===m.id?e.jsx(V,{value:n,onChange:C=>c(m.id,C),onBlur:()=>s(null),style:{width:180,background:"#1b2a3a",color:"#9ca3af"},styles:{popup:{root:{background:"#1b2a3a",border:"1px solid rgba(255, 255, 255, 0.1)",zIndex:1050}}},classNames:{popup:{root:"custom-select-dropdown"}},options:i,autoFocus:!0,onClick:C=>C.stopPropagation()}):e.jsx(_,{color:b(n),className:"cursor-pointer",onClick:C=>{C.stopPropagation(),s(m.id)},children:n}),width:180},{title:"Monto",key:"monto",width:120,render:(n,m)=>{const C=m.monto,S=m.montoAbonado||0,j=C-S;return e.jsxs("div",{children:[e.jsx(P,{strong:!0,style:{color:"#ffffff"},children:I(C)}),m.estado==="Cobrado parcialmente"&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsxs(P,{type:"secondary",className:"text-11",style:{color:"#ffffff"},children:["Abonado: ",I(S)]}),e.jsx("br",{}),e.jsxs(P,{type:"warning",className:"text-11",style:{color:"#ffffff"},children:["Pendiente: ",I(j)]})]})]})}},{title:"Fecha Vencimiento",dataIndex:"fechaVencimiento",key:"fechaVencimiento",width:120,render:n=>e.jsx(P,{style:{color:"#ffffff"},children:new Date(n).toLocaleDateString("es-CO")})},{title:"Acciones",render:(n,m)=>e.jsx(Ge,{title:"Editar estado del cobro",children:e.jsx(R,{type:"default",shape:"circle",icon:e.jsx(ie,{size:16}),onClick:C=>{C.stopPropagation(),s(m.id)}})}),width:100}],f=n=>{const m=n.monto,C=n.montoAbonado||0,S=m-C;return e.jsx(U,{className:"mobile-cobro-card",onClick:()=>o(n),style:{marginBottom:"16px",background:"rgba(31, 41, 55, 0.95)",backdropFilter:"blur(20px)",border:"1px solid rgba(55, 65, 81, 0.5)",borderRadius:"12px",cursor:"pointer"},children:e.jsxs(Z,{gutter:[16,16],children:[e.jsx(E,{span:24,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{className:"cobro-mobile-image-container",style:{width:80,height:80,minWidth:80,minHeight:80},children:(()=>{const j=re(n.propiedad.imagenUrl);return!h[n.id]&&j?e.jsxs(e.Fragment,{children:[!l[n.id]&&e.jsx("div",{className:"cobro-image-shimmer"}),e.jsx("img",{src:j,alt:n.propiedad.titulo,className:`cobro-mobile-image ${l[n.id]?"loaded":""}`,onLoad:()=>p(D=>({...D,[n.id]:!0})),onError:()=>x(D=>({...D,[n.id]:!0}))})]}):e.jsx("div",{className:"cobro-image-fallback"})})()}),e.jsxs("div",{style:{flex:1},children:[e.jsx(P,{strong:!0,style:{color:"#ffffff",fontSize:"16px",display:"block",marginBottom:"4px"},children:n.propiedad.titulo}),e.jsxs(P,{style:{color:"#9ca3af",fontSize:"12px",display:"block"},children:["ðŸ“ ",n.propiedad.direccion]})]})]})}),e.jsx(E,{span:24,children:e.jsxs("div",{style:{padding:"12px",background:"rgba(55, 65, 81, 0.3)",borderRadius:"8px"},children:[e.jsx(P,{strong:!0,style:{color:"#ffffff",display:"block",marginBottom:"8px"},children:n.cliente.nombre}),e.jsxs(P,{style:{color:"#9ca3af",fontSize:"12px",display:"block"},children:["ðŸ“ž ",n.cliente.telefono]}),e.jsxs(P,{style:{color:"#9ca3af",fontSize:"12px",display:"block"},children:["âœ‰ï¸ ",n.cliente.email]})]})}),e.jsxs(E,{span:12,children:[e.jsx(P,{type:"secondary",style:{color:"#9ca3af",fontSize:"12px",display:"block",marginBottom:"4px"},children:"Estado"}),d===n.id?e.jsx(V,{value:n.estado,onChange:j=>c(n.id,j),onBlur:()=>s(null),style:{width:"100%",background:"#1b2a3a",color:"#9ca3af"},options:i,autoFocus:!0,onClick:j=>j.stopPropagation()}):e.jsx(_,{color:b(n.estado),className:"cursor-pointer",onClick:j=>{j.stopPropagation(),s(n.id)},children:n.estado})]}),e.jsxs(E,{span:12,children:[e.jsx(P,{type:"secondary",style:{color:"#9ca3af",fontSize:"12px",display:"block",marginBottom:"4px"},children:"Monto"}),e.jsx(P,{strong:!0,style:{color:"#ffffff",display:"block"},children:I(m)}),n.estado==="Cobrado parcialmente"&&e.jsxs(e.Fragment,{children:[e.jsxs(P,{style:{color:"#9ca3af",fontSize:"11px",display:"block"},children:["Abonado: ",I(C)]}),e.jsxs(P,{style:{color:"#fbbf24",fontSize:"11px",display:"block"},children:["Pendiente: ",I(S)]})]})]}),e.jsxs(E,{span:12,children:[e.jsx(P,{type:"secondary",style:{color:"#9ca3af",fontSize:"12px",display:"block",marginBottom:"4px"},children:"Vencimiento"}),e.jsx(P,{style:{color:"#ffffff",display:"block"},children:new Date(n.fechaVencimiento).toLocaleDateString("es-CO")})]}),e.jsx(E,{span:12,children:e.jsx(R,{type:"default",icon:e.jsx(ie,{size:16}),onClick:j=>{j.stopPropagation(),s(n.id)},block:!0,style:{background:"rgba(55, 65, 81, 0.8)",border:"1px solid rgba(75, 85, 99, 0.5)",color:"white"},children:"Editar Estado"})})]})},n.id)};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          .custom-select-dropdown .ant-select-item-option {
            color: #9ca3af !important;
            background-color: #1b2a3a !important;
          }
          .custom-select-dropdown .ant-select-item-option:hover {
            background-color: #2a3f4f !important;
          }
          .custom-select-dropdown .ant-select-item-option-selected {
            background-color: #33F491 !important;
            color: #222222 !important;
          }
          .ant-select-selector {
            color: #9ca3af !important;
          }
          .ant-select-selection-item {
            color: #9ca3af !important;
          }
        `}),e.jsx("div",{className:"liquid-glass overflow-hidden desktop-table-view",children:e.jsx(Ue,{dataSource:a,columns:y,pagination:{pageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","50"],showTotal:(n,m)=>`${m[0]}-${m[1]} de ${n} cobros`,position:["bottomCenter"]},loading:t,rowKey:"id",style:{background:"transparent"},onRow:n=>({onClick:()=>o(n),style:{cursor:"pointer"}})})}),e.jsx("div",{className:"mobile-cards-view",children:t?e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#9ca3af"},children:"Cargando..."}):a.length===0?e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#9ca3af"},children:"No hay cobros para mostrar"}):a.map(f)})]})},xa=({data:a})=>{const[t,o]=g.useState("por-cobrar"),r=i=>i.split(" ").map(c=>c[0]).join("").toUpperCase(),d=i=>{switch(i){case"Pagado":return"success";case"Por cobrar":return"warning";case"Atrasado":return"error";case"Cobrado parcialmente":return"warning";default:return"warning"}},s=i=>{switch(i){case"Pagado":return"Pagado";case"Por cobrar":return"Por cobrar";case"Atrasado":return"Atrasado";case"Cobrado parcialmente":return"Parcial";default:return i}},p=(i=>i==="por-cobrar"?a.filter(c=>["Por cobrar","Atrasado","Cobrado parcialmente"].includes(c.estado)).sort((c,y)=>new Date(c.fechaVencimiento).getTime()-new Date(y.fechaVencimiento).getTime()):a.filter(c=>c.estado==="Pagado").sort((c,y)=>{const f=c.fechaPago?new Date(c.fechaPago).getTime():0;return(y.fechaPago?new Date(y.fechaPago).getTime():0)-f}))(t),h=i=>{const c=new Date(i),y=c.getDate().toString().padStart(2,"0"),f=(c.getMonth()+1).toString().padStart(2,"0"),n=c.getFullYear();return`${y}/${f}/${n}`},x=i=>{console.log("WhatsApp clicked for:",i.cliente.nombre)},b=i=>{console.log("Ver clicked for:",i)};return e.jsx("div",{className:"notif-panel",children:e.jsx(Ze,{activeKey:t,onChange:o,size:"small",items:[{key:"por-cobrar",label:"Por cobrar",children:e.jsx("div",{className:"notif-list",children:p.map(i=>e.jsxs("div",{className:"notif-item",children:[e.jsx("div",{className:"avatar",children:r(i.cliente.nombre)}),e.jsxs("div",{className:"content",children:[e.jsx("div",{className:"client-name",children:i.cliente.nombre}),e.jsx("div",{className:"property-title",children:i.propiedad.titulo}),e.jsxs("div",{className:"date-info",children:["Vence: ",h(i.fechaVencimiento)]})]}),e.jsxs("div",{className:"amount",children:[e.jsx("div",{className:"amount-value",children:de(i.monto,i.divisa)}),e.jsx("div",{className:`status-chip ${d(i.estado)}`,children:s(i.estado)})]}),e.jsxs("div",{className:"actions",children:[e.jsx(R,{size:"small",className:"action-btn whatsapp",icon:e.jsx(Je,{size:12}),onClick:()=>x(i)}),e.jsx(R,{size:"small",className:"action-btn",icon:e.jsx(le,{size:12}),onClick:()=>b(i)})]})]},i.id))})},{key:"pagado",label:"Pagado",children:e.jsx("div",{className:"notif-list",children:p.map(i=>e.jsxs("div",{className:"notif-item",children:[e.jsx("div",{className:"avatar",children:r(i.cliente.nombre)}),e.jsxs("div",{className:"content",children:[e.jsx("div",{className:"client-name",children:i.cliente.nombre}),e.jsx("div",{className:"property-title",children:i.propiedad.titulo}),e.jsxs("div",{className:"date-info",children:["Pagado: ",i.fechaPago?h(i.fechaPago):"N/A"]})]}),e.jsxs("div",{className:"amount",children:[e.jsx("div",{className:"amount-value",children:de(i.monto,i.divisa)}),e.jsx("div",{className:`status-chip ${d(i.estado)}`,children:s(i.estado)})]}),e.jsx("div",{className:"actions",children:e.jsx(R,{size:"small",className:"action-btn",icon:e.jsx(le,{size:12}),onClick:()=>b(i)})})]},i.id))})}]})})},{Text:ue}=L,Ca=({data:a,loading:t})=>{const o=s=>{switch(s){case"Pagado":return"success";case"Por cobrar":return"processing";case"Atrasado":return"error";case"Cobrado parcialmente":return"warning";default:return"default"}},r=s=>a.filter(l=>{const p=ce(l.fechaVencimiento).format("YYYY-MM-DD"),h=l.fechaPago?ce(l.fechaPago).format("YYYY-MM-DD"):null,x=s.format("YYYY-MM-DD");return p===x||h===x}),d=(s,l)=>{if(l.type==="date"){const p=r(s);return p.length===0?null:e.jsxs("ul",{className:"calendar-cobros-list m-0 p-0",children:[p.slice(0,2).map(h=>e.jsx("li",{style:{marginBottom:2},children:e.jsx(Ke,{status:o(h.estado),text:e.jsx(ue,{style:{fontSize:"10px",lineHeight:"12px"},ellipsis:{tooltip:`${h.cliente.nombre} - ${h.propiedad.titulo}`},children:h.cliente.nombre.split(" ")[0]})})},h.id)),p.length>2&&e.jsx("li",{children:e.jsxs(ue,{type:"secondary",style:{fontSize:"9px"},children:["+",p.length-2]})})]})}return null};return t?e.jsx(U,{loading:!0,className:"modern-card",children:e.jsx("div",{style:{height:350}})}):e.jsx("div",{className:"calendar-panel",children:e.jsxs(U,{className:"modern-card",style:{height:"fit-content"},children:[e.jsxs("div",{className:"calendar-legend",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-dot success"}),e.jsx("span",{children:"Pagado"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-dot processing"}),e.jsx("span",{children:"Por cobrar"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-dot warning"}),e.jsx("span",{children:"Parcial"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-dot error"}),e.jsx("span",{children:"Atrasado"})]})]}),e.jsx(fe,{cellRender:d,fullscreen:!1,style:{background:"transparent"},onSelect:s=>{const l=r(s);l.length>0&&console.log("Cobros del dÃ­a:",l)}})]})})};var T=(a=>(a.Pagado="Pagado",a.PorCobrar="Por cobrar",a.Atrasado="Atrasado",a.CobradoParcialmente="Cobrado parcialmente",a))(T||{});const ge=[{nombre:"MarÃ­a GonzÃ¡lez PÃ©rez",telefono:"+56 9 9123 4567",email:"maria.gonzalez@email.cl"},{nombre:"Carlos RodrÃ­guez Silva",telefono:"+56 9 8765 4321",email:"carlos.rodriguez@email.cl"},{nombre:"Ana Patricia LÃ³pez",telefono:"+56 9 7654 3210",email:"ana.lopez@email.cl"},{nombre:"Javier Morales Castro",telefono:"+56 9 6543 2109",email:"javier.morales@email.cl"},{nombre:"SofÃ­a MartÃ­nez Rojas",telefono:"+56 9 5432 1098",email:"sofia.martinez@email.cl"},{nombre:"Roberto ValdÃ©s Torres",telefono:"+56 9 4321 0987",email:"roberto.valdes@email.cl"},{nombre:"Claudia PÃ©rez MuÃ±oz",telefono:"+56 9 3210 9876",email:"claudia.perez@email.cl"},{nombre:"Diego Fuentes Soto",telefono:"+56 9 2109 8765",email:"diego.fuentes@email.cl"},{nombre:"Inmobiliaria Centro SA",telefono:"+56 2 2345 6789",email:"contacto@inmocentro.cl"},{nombre:"CorporaciÃ³n Edificios SpA",telefono:"+56 2 2876 5432",email:"admin@corpedificios.cl"}],va=()=>{const a=Qe.propiedades.filter(t=>t.arriendo===!0&&t.venta===!1&&t.propiedadArriendo);return a.map((t,o)=>{const r=ge[o%ge.length],d=t.propiedadArriendo,s=Math.random();let l,p,h;s<.6?l=T.PorCobrar:s<.8?(l=T.Pagado,p=new Date(2025,9,Math.floor(Math.random()*20)+1)):s<.95?l=T.Atrasado:(l=T.CobradoParcialmente,h=Math.floor(d.precioPrincipal*.6));const x=Math.floor(o*(60/a.length)),b=new Date(2025,9,5+x);return{id:`cobro-${t.id}`,propiedad:{id:t.id,titulo:t.titulo,direccion:`${t.nombreCalle} ${t.numeroCalle}${t.unidad?`, ${t.unidad}`:""}, ${t.comuna}`,imagenUrl:t.imagenPrincipal||void 0},cliente:{nombre:r.nombre,telefono:r.telefono,email:r.email},estado:l,monto:d.precioPrincipal,divisa:d.divisa,fechaVencimiento:b,fechaPago:p,montoAbonado:h,observaciones:l===T.Atrasado?"Cliente con historial de pagos atrasados. CuriOso recomienda seguimiento.":void 0}})},z=va(),ja=async a=>(await J(),z),ya=async(a,t)=>{await J();const o=z.findIndex(r=>r.id===a);if(o===-1)throw new Error(`Cobro with id ${a} not found`);return z[o]={...z[o],...t},z[o]},Sa=async a=>{await J();const t=z.filter(s=>s.estado===T.PorCobrar).length,o=z.filter(s=>s.estado===T.Atrasado).length,r=z.filter(s=>s.estado===T.Pagado).length,d=z.reduce((s,l)=>s+l.monto,0);return{pendientesCobrar:t,atrasados:o,cobradosExito:r,totalMonto:d}},Q=()=>[{id:"cobro-hotdesk-001",propiedad:{id:"esp-002",titulo:"Hot Desk Mensual - SofÃ­a MartÃ­nez",direccion:"Zona Norte, Piso 1"},cliente:{nombre:"SofÃ­a MartÃ­nez",telefono:"+56 9 8765 4321",email:"sofia.martinez@email.cl"},estado:"Pagado",monto:12e4,divisa:"CLP",fechaVencimiento:new Date(2025,10,5),fechaPago:new Date(2025,10,3)},{id:"cobro-oficina-001",propiedad:{id:"esp-001",titulo:"Oficina Privada 201 - Tech Startup",direccion:"Ala Norte, Piso 2"},cliente:{nombre:"Tech Startup SpA",telefono:"+56 9 3456 7890",email:"contacto@techstartup.cl"},estado:"Por cobrar",monto:45e4,divisa:"CLP",fechaVencimiento:new Date(2025,11,1)},{id:"cobro-sala-001",propiedad:{id:"esp-004",titulo:"Sala Laurel - Evento Corporativo",direccion:"Sector Central, Piso 1"},cliente:{nombre:"CorporaciÃ³n ABC",telefono:"+56 2 2345 6789",email:"eventos@corpabc.cl"},estado:"Por cobrar",monto:18e4,divisa:"CLP",fechaVencimiento:new Date(2025,10,15),observaciones:"Reserva: 4 horas + coffee break"},{id:"cobro-virtual-001",propiedad:{id:"esp-006",titulo:"Oficina Virtual - Consultora ABC",direccion:"Servicio digital"},cliente:{nombre:"Consultora ABC Ltda",telefono:"+56 9 4567 8901",email:"info@consultoraabc.cl"},estado:"Atrasado",monto:75e3,divisa:"CLP",fechaVencimiento:new Date(2025,9,28),observaciones:"Cliente contactado. Confirma pago para esta semana."},{id:"cobro-flex-001",propiedad:{id:"esp-003",titulo:"Escritorio Flexible 12 dÃ­as - Juan PÃ©rez",direccion:"Zona Flexible"},cliente:{nombre:"Juan PÃ©rez",telefono:"+56 9 2345 6789",email:"juan.perez@email.cl"},estado:"Pagado",monto:12e4,divisa:"CLP",fechaVencimiento:new Date(2025,10,10),fechaPago:new Date(2025,10,8)},{id:"cobro-sala-002",propiedad:{id:"esp-004",titulo:"Sala ReuniÃ³n - Workshop Consultora XYZ",direccion:"Sala 15 personas"},cliente:{nombre:"Consultora XYZ",telefono:"+56 9 8765 1234",email:"contacto@xyz.cl"},estado:"Cobrado parcialmente",monto:12e4,divisa:"CLP",fechaVencimiento:new Date(2025,10,20),montoAbonado:6e4,observaciones:"AbonÃ³ $60k, saldo pendiente $60k"}],wa=a=>{const t=a.filter(s=>s.estado==="Por cobrar"||s.estado==="Cobrado parcialmente"),o=a.filter(s=>s.estado==="Atrasado"),r=a.filter(s=>s.estado==="Pagado"),d=a.reduce((s,l)=>s+l.monto,0);return{pendientesCobrar:t.length,atrasados:o.length,cobradosExito:r.length,totalMonto:d}},Pa=async a=>{const{activePreset:t}=K.getState();return t==="coworking"?(await new Promise(o=>setTimeout(o,400)),Q()):ja()},Na=async a=>{const{activePreset:t}=K.getState();if(t==="coworking"){await new Promise(r=>setTimeout(r,300));const o=Q();return wa(o)}return Sa()},$a=async(a,t)=>{const{activePreset:o}=K.getState();if(o==="coworking"){await new Promise(s=>setTimeout(s,300));const d=Q().find(s=>s.id===a);if(!d)throw new Error("Cobro no encontrado");return{...d,...t}}return ya(a,t)},{Title:Ma}=L,Ta=()=>{const[a,t]=g.useState([]),[o,r]=g.useState({pendientesCobrar:0,atrasados:0,cobradosExito:0,totalMonto:0}),[d,s]=g.useState(!0),[l,p]=g.useState(""),[h,x]=g.useState("list"),[b,i]=g.useState(!1),{empresa:c}=ea(),{message:y}=aa.useApp(),f=g.useCallback(async()=>{try{s(!0);const v=await Pa((c==null?void 0:c.id)||"");t(v)}catch(v){console.error(v)}finally{s(!1)}},[c==null?void 0:c.id]),n=g.useCallback(async()=>{try{const v=await Na((c==null?void 0:c.id)||"");r(v)}catch(v){console.error(v)}},[c==null?void 0:c.id]);g.useEffect(()=>{f(),n()},[f,n]);const m=a.filter(v=>v.propiedad.titulo.toLowerCase().includes(l.toLowerCase())||v.cliente.nombre.toLowerCase().includes(l.toLowerCase())||v.cliente.email.toLowerCase().includes(l.toLowerCase())),C=v=>{console.log("Cobro clicked:",v)},S=()=>{console.log("Nuevo cobro clicked")},j=()=>{i(!b)},D=async(v,M)=>{try{await $a(v,{estado:M}),y.success("Estado del cobro actualizado"),await f(),await n()}catch(H){console.error("Error updating cobro estado:",H),y.error("Error al actualizar el estado del cobro")}},O=[{id:1,type:"warning",message:"ðŸ» Oso Cuidadoso ha encontrado 3 clientes con riesgo de atraso. Click para verlos.",action:()=>console.log("Ver clientes en riesgo")}];return e.jsxs("div",{style:{padding:"0 16px 24px 16px"},children:[e.jsx(pa,{setBusqueda:p,onNuevoCobro:S,showNotifications:b,onNotificationsClick:j}),e.jsx(fa,{stats:o,loading:d}),b&&O.map(v=>e.jsx("div",{style:{background:v.type==="warning"?"linear-gradient(135deg, #F59E0B 0%, #D97706 100%)":"linear-gradient(135deg, #3B82F6 0%, #2563EB 100%)",color:"white",padding:"16px 20px",borderRadius:"12px",marginTop:"16px",marginBottom:"8px",cursor:"pointer",textAlign:"center",fontFamily:"Poppins, sans-serif",fontWeight:"500",fontSize:"14px",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)"},onClick:v.action,onMouseOver:M=>{M.currentTarget.style.transform="translateY(-2px)",M.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseOut:M=>{M.currentTarget.style.transform="translateY(0)",M.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:v.message},v.id)),e.jsxs("div",{className:"modern-card mt-24",style:{padding:"24px"},children:[e.jsxs("div",{className:"d-flex align-center justify-between",children:[e.jsx(Ma,{level:3,className:"m-0",children:"Cobros"}),e.jsxs(ta.Compact,{children:[e.jsx(R,{icon:e.jsx(oa,{}),type:h==="list"?"primary":"default",onClick:()=>x("list"),style:{background:h==="list"?"#33F491":"transparent",color:h==="list"?"#222222":"#ffffff",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px 0 0 8px"},children:"Lista"}),e.jsx(R,{icon:e.jsx(na,{}),type:h==="calendar"?"primary":"default",onClick:()=>x("calendar"),style:{background:h==="calendar"?"#33F491":"transparent",color:h==="calendar"?"#222222":"#ffffff",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"0 8px 8px 0"},children:"Calendario"})]})]}),e.jsx("div",{style:{marginTop:"24px"},children:h==="list"?e.jsx(ba,{data:m,loading:d,onCobroClick:C,onEstadoChange:D}):e.jsxs("div",{className:"cobros-calendario",children:[e.jsx(xa,{data:m}),e.jsx(Ca,{data:m,loading:d})]})})]})]})};export{Ta as default};

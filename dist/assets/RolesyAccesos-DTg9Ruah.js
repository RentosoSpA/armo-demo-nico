import{c as ee,s as Z,x as se,F as _,f as D,r as l,b_ as ce,j as e,b7 as H,S as L,B as j,I as te,w as de,b6 as ae,bc as pe,D as ue,d as z,bs as xe,b9 as re,a3 as N,bW as P,k as me,bb as G,bt as he,b$ as ge,c0 as fe,bZ as ye,T as be,a as W,bu as ne}from"./index-BmXdxNCh.js";import{c as ie,u as ve,g as je,t as ke,d as we}from"./invitationLinksServiceSupabase-CXDKegVI.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],X=ee("copy",Ce);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],K=ee("user-plus",Se),Ee=async p=>{const{data:x,error:f}=await Z.from("profiles").select(`
      id,
      user_id,
      full_name,
      company_name,
      phone,
      empresa_id,
      created_at,
      updated_at
    `).eq("empresa_id",p);if(f)throw console.error("Error fetching profiles:",f),f;return await Promise.all((x||[]).map(async d=>{const{data:t}=await Z.from("user_roles").select("role").eq("user_id",d.user_id).eq("empresa_id",p).single();return{...d,role:(t==null?void 0:t.role)||"agent"}}))},oe={},_e={dashboard:"Tablero",oportunidades:"Oportunidades",propiedades:"Propiedades",visitas:"Visitas",contratos:"Contratos",cobros:"Cobros",propietarios:"Propietarios",reportes:"Reportes",usuarios:"Usuarios y Accesos",integraciones:"Integraciones",agencia:"Configuración de Agencia"},Le=()=>_e,J=p=>{const x={create:!0,read:!0,update:!0,delete:!0},f={create:!1,read:!0,update:!1,delete:!1},i={create:!0,read:!0,update:!0,delete:!1},d=["dashboard","oportunidades","propiedades","visitas","contratos","cobros","propietarios","reportes","usuarios","integraciones","agencia"];switch(p){case"owner":case"admin":return d.reduce((t,n)=>({...t,[n]:x}),{});case"manager":return d.reduce((t,n)=>n==="integraciones"||n==="agencia"?{...t,[n]:{...x,delete:!1}}:{...t,[n]:x},{});case"agent":return d.reduce((t,n)=>n==="oportunidades"||n==="visitas"?{...t,[n]:i}:{...t,[n]:f},{});case"viewer":return d.reduce((t,n)=>({...t,[n]:f}),{});default:return d.reduce((t,n)=>({...t,[n]:f}),{})}},ze=async p=>(await se(),oe[p]||null),Ie=async(p,x)=>{await se(),oe[p]=x},Te=[{value:"admin",label:"Administrador"},{value:"agent",label:"Agente"},{value:"supervisor",label:"Supervisor"},{value:"assistant",label:"Asistente"}],Ae=({visible:p,onClose:x,onRefresh:f})=>{const[i]=_.useForm(),{message:d}=D.useApp(),[t,n]=l.useState(!1),[c,y]=l.useState(null),[k,h]=l.useState(!1),{empresa:S}=ce(),b=async()=>{if(!(S!=null&&S.id)){d.error("No se encontró información de la empresa");return}try{const o=await i.validateFields();n(!0);const C=await ie(S.id,o.rol,{maxUses:1,expiresAt:new Date(Date.now()+10080*60*1e3).toISOString()});if(C.success&&C.link){const M=`${window.location.origin}/registro-agente?token=${C.link.token}`;y(M),d.success("Link de invitación creado exitosamente"),f&&f()}else throw new Error(C.error||"Error al crear invitación")}catch(o){console.error("Error:",o),o instanceof Error&&d.error(o.message||"Error al crear la invitación")}finally{n(!1)}},I=async()=>{if(c)try{await navigator.clipboard.writeText(c),h(!0),d.success("Link copiado al portapapeles"),setTimeout(()=>h(!1),2e3)}catch{d.error("Error al copiar el link")}},u=()=>{i.resetFields(),y(null),h(!1),x()};return e.jsx(H,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#e6f1ff"},children:[e.jsx(K,{size:20}),e.jsx("span",{children:"Invitar usuario"})]}),open:p,onCancel:u,footer:null,width:500,centered:!0,styles:{content:{background:"rgba(17, 25, 40, 0.95)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.14)",borderRadius:"16px"},header:{background:"transparent",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",paddingBottom:"16px"}},children:e.jsx("div",{style:{marginTop:"24px"},children:c?e.jsxs(e.Fragment,{children:[e.jsx("p",{style:{color:"#8892b0",marginBottom:"16px",fontSize:"14px"},children:"¡Link de invitación generado! Compártelo con el nuevo usuario:"}),e.jsx(te.TextArea,{value:c,readOnly:!0,rows:3,style:{marginBottom:"16px",fontFamily:"monospace",fontSize:"12px"}}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx(j,{onClick:u,size:"large",children:"Cerrar"}),e.jsx(j,{type:"primary",icon:k?e.jsx(de,{size:16}):e.jsx(X,{size:16}),onClick:I,size:"large",children:k?"Copiado":"Copiar link"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{style:{color:"#8892b0",marginBottom:"24px",fontSize:"14px"},children:"Selecciona el rol para el nuevo usuario y genera un link de invitación"}),e.jsxs(_,{form:i,layout:"vertical",onFinish:b,children:[e.jsx(_.Item,{name:"rol",label:"Rol",rules:[{required:!0,message:"Por favor seleccione un rol"}],children:e.jsx(L,{placeholder:"Selecciona un rol",size:"large",options:Te})}),e.jsx(_.Item,{style:{marginBottom:0,marginTop:"32px"},children:e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx(j,{onClick:u,size:"large",children:"Cancelar"}),e.jsx(j,{type:"primary",htmlType:"submit",loading:t,icon:e.jsx(K,{size:16}),size:"large",children:"Generar link de invitación"})]})})]})]})})})},Ne=[{label:"Administrador",value:"admin"},{label:"Agente",value:"agent"},{label:"Supervisor",value:"supervisor"},{label:"Asistente",value:"assistant"}],Pe=({visible:p,onClose:x,onSuccess:f})=>{const[i]=_.useForm(),[d,t]=l.useState(!1),[n,c]=l.useState(null),{message:y}=D.useApp(),{empresa:k}=ae(),h=async()=>{if(!k){y.error("No se encontró información de la empresa");return}try{const u=await i.validateFields();t(!0);const o=await ie(k.id,u.role,{maxUses:u.max_uses||void 0,expiresAt:u.expires_at?z(u.expires_at).toISOString():void 0});if(o.success&&o.link){const C=`${window.location.origin}/registro-agente?token=${o.link.token}`;c(C),y.success("Link de invitación creado exitosamente")}else y.error(o.error||"Error al crear el link de invitación")}catch(u){console.error("Error creating invitation link:",u),y.error("Error al crear el link de invitación")}finally{t(!1)}},S=()=>{n&&(navigator.clipboard.writeText(n),y.success("Link copiado al portapapeles"))},b=()=>{i.resetFields(),c(null),x()},I=()=>{f(),b()};return e.jsx(H,{title:"Generar Link de Invitación",open:p,onCancel:b,footer:n?e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx(j,{onClick:I,children:"Cerrar"}),e.jsx(j,{type:"primary",icon:e.jsx(X,{size:16}),onClick:S,children:"Copiar Link"})]}):e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx(j,{onClick:b,children:"Cancelar"}),e.jsx(j,{type:"primary",loading:d,onClick:h,children:"Generar Link"})]}),width:600,children:n?e.jsxs("div",{children:[e.jsx("p",{style:{marginBottom:16},children:"¡Link de invitación generado exitosamente! Copia y comparte este link con el nuevo agente:"}),e.jsx(te.TextArea,{value:n,readOnly:!0,autoSize:{minRows:2,maxRows:4},style:{fontFamily:"monospace",fontSize:"12px"}})]}):e.jsxs(_,{form:i,layout:"vertical",initialValues:{role:"agent"},children:[e.jsx(_.Item,{name:"role",label:"Rol del Agente",rules:[{required:!0,message:"Por favor selecciona un rol"}],children:e.jsx(L,{options:Ne,placeholder:"Seleccionar rol"})}),e.jsx(_.Item,{name:"max_uses",label:"Máximo de Usos (opcional)",tooltip:"Deja en blanco para usos ilimitados",children:e.jsx(pe,{min:1,placeholder:"Usos ilimitados",style:{width:"100%"}})}),e.jsx(_.Item,{name:"expires_at",label:"Fecha de Expiración (opcional)",tooltip:"Deja en blanco para que nunca expire",children:e.jsx(ue,{style:{width:"100%"},placeholder:"Nunca expira",disabledDate:u=>u&&u<z().startOf("day")})})]})})},Re=[{label:"Administrador",value:"admin"},{label:"Agente",value:"agent"},{label:"Supervisor",value:"supervisor"},{label:"Asistente",value:"assistant"}],Fe=({visible:p,link:x,onClose:f,onSuccess:i})=>{const[d]=_.useForm(),[t,n]=l.useState(!1),{message:c}=D.useApp();l.useEffect(()=>{x&&p&&d.setFieldsValue({role:x.role})},[x,p,d]);const y=async()=>{if(x)try{const k=await d.validateFields();n(!0);const h=await ve(x.id,k.role);h.success?(c.success("Rol actualizado correctamente"),i()):c.error(h.error||"Error al actualizar el rol")}catch(k){console.error("Error updating role:",k),c.error("Error al actualizar el rol")}finally{n(!1)}};return e.jsx(H,{title:"Editar Rol del Link de Invitación",open:p,onCancel:f,footer:[e.jsx(j,{onClick:f,children:"Cancelar"},"cancel"),e.jsx(j,{type:"primary",loading:t,onClick:y,children:"Guardar Cambios"},"submit")],width:500,children:e.jsx(_,{form:d,layout:"vertical",children:e.jsx(_.Item,{name:"role",label:"Nuevo Rol",rules:[{required:!0,message:"Por favor selecciona un rol"}],children:e.jsx(L,{options:Re,placeholder:"Seleccionar rol"})})})})},Be={admin:"Administrador",agent:"Agente",supervisor:"Supervisor",assistant:"Asistente"},Me=()=>{const[p,x]=l.useState([]),[f,i]=l.useState(!1),[d,t]=l.useState(!1),[n,c]=l.useState(!1),[y,k]=l.useState(null),[h,S]=l.useState({}),[b,I]=l.useState({}),{message:u}=D.useApp(),{empresa:o}=ae();l.useEffect(()=>{o&&C()},[o]),l.useEffect(()=>{const r={};return Object.keys(b).forEach(s=>{b[s]&&h[s]>0&&(r[s]=setInterval(()=>{S(m=>{const w=(m[s]||7)-1;return w<=0?(r[s]&&clearInterval(r[s]),{...m,[s]:0}):{...m,[s]:w}})},1e3))}),()=>{Object.values(r).forEach(s=>clearInterval(s))}},[b,h]);const C=async()=>{if(o){i(!0);try{const r=await je(o.id);x(r)}catch(r){console.error("Error loading invitation links:",r),u.error("Error al cargar los links de invitación")}finally{i(!1)}}},M=r=>{const s=`${window.location.origin}/registro-agente?token=${r}`;navigator.clipboard.writeText(s),u.success("Link copiado al portapapeles")},U=async(r,s)=>{const m=await ke(r,!s);m.success?(u.success(`Link ${s?"desactivado":"activado"} correctamente`),C()):u.error(m.error||"Error al cambiar el estado del link")},B=r=>{k(r),c(!0)},O=r=>{I({...b,[r]:!0}),S({...h,[r]:7})},T=r=>{I({...b,[r]:!1}),S({...h,[r]:7})},q=async r=>{I({...b,[r]:!1});const s=await we(r);s.success?(u.success("Link eliminado correctamente"),C()):u.error(s.error||"Error al eliminar el link"),S({...h,[r]:7})},V=[{title:"Token",dataIndex:"token",key:"token",width:200,render:r=>e.jsxs("code",{style:{fontSize:"12px",color:"#33F491"},children:[r.substring(0,20),"..."]})},{title:"Rol",dataIndex:"role",key:"role",width:150,render:r=>e.jsx(N,{color:"blue",children:Be[r]||r})},{title:"Creado",dataIndex:"created_at",key:"created_at",width:120,render:r=>z(r).format("DD/MM/YYYY")},{title:"Usos",key:"uses",width:150,render:(r,s)=>{const m=s.max_uses===null,w=s.current_uses||0,A=m?0:w/(s.max_uses||1)*100,R=!m&&A>=80,F=!m&&w>=(s.max_uses||0);return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("span",{style:{color:F?"#ff4d4f":R?"#faad14":"inherit"},children:[w," / ",s.max_uses||"∞"]}),F&&e.jsx(N,{color:"error",children:"Máximo alcanzado"}),R&&!F&&e.jsx(N,{color:"warning",children:"Cerca del límite"})]})}},{title:"Expira",dataIndex:"expires_at",key:"expires_at",width:150,render:r=>{if(!r)return e.jsx(N,{color:"green",children:"Nunca"});const s=z(r),m=s.isBefore(z()),w=s.diff(z(),"day"),A=w>=0&&w<=7;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:s.format("DD/MM/YYYY")}),m&&e.jsx(N,{color:"error",children:"Expirado"}),A&&!m&&e.jsx(N,{color:"warning",children:"Expira pronto"})]})}},{title:"Estado",key:"status",width:150,render:(r,s)=>{const m=s.expires_at&&z(s.expires_at).isBefore(z()),w=s.current_uses||0,A=s.max_uses!==null&&w>=s.max_uses;return s.is_active?m?e.jsx(N,{color:"error",children:"Expirado"}):A?e.jsx(N,{color:"error",children:"Agotado"}):e.jsx(P,{checked:s.is_active||!1,onChange:()=>U(s.id,s.is_active||!1),checkedChildren:"Activo",unCheckedChildren:"Inactivo"}):e.jsx(N,{color:"default",children:"Inactivo"})}},{title:"Acciones",key:"actions",width:200,fixed:"right",render:(r,s)=>{const m=s.expires_at&&z(s.expires_at).isBefore(z()),w=s.current_uses||0,A=s.max_uses!==null&&w>=s.max_uses,R=s.is_active&&!m&&!A;return e.jsxs(me,{children:[e.jsx(G,{title:R?"Copiar link":"Link no disponible",children:e.jsx(j,{type:"text",size:"small",icon:e.jsx(X,{size:16}),onClick:()=>M(s.token),disabled:!R})}),e.jsx(G,{title:"Editar rol",children:e.jsx(j,{type:"text",size:"small",icon:e.jsx(he,{size:16}),onClick:()=>B(s)})}),e.jsx(ge,{open:b[s.id],onOpenChange:F=>{F?O(s.id):T(s.id)},title:"¿Eliminar link de invitación?",description:"Esta acción no se puede deshacer. Los links ya compartidos dejarán de funcionar.",onConfirm:()=>q(s.id),okText:h[s.id]>0?`Espera ${h[s.id]}s...`:"Sí, eliminar",cancelText:"Cancelar",okButtonProps:{danger:!0,disabled:h[s.id]>0},children:e.jsx(G,{title:"Eliminar",children:e.jsx(j,{type:"text",size:"small",danger:!0,icon:e.jsx(fe,{size:16}),onClick:()=>O(s.id)})})})]})}}];return e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:16,display:"flex",justifyContent:"flex-end"},children:e.jsx(j,{type:"primary",icon:e.jsx(xe,{size:16}),onClick:()=>t(!0),children:"Generar Nuevo Link"})}),e.jsx(re,{columns:V,dataSource:p,rowKey:"id",loading:f,pagination:{pageSize:10,showSizeChanger:!0,showTotal:r=>`Total ${r} links`},scroll:{x:1e3}}),e.jsx(Pe,{visible:d,onClose:()=>t(!1),onSuccess:()=>{C(),t(!1)}}),e.jsx(Fe,{visible:n,link:y,onClose:()=>{c(!1),k(null)},onSuccess:()=>{C(),c(!1),k(null)}})]})},De=`
  .custom-select-usuario .ant-select-selector {
    background-color: #2a3441 !important;
    border-color: rgba(255, 255, 255, 0.1) !important;
    border-radius: 8px !important;
    color: rgba(255, 255, 255, 0.85) !important;
  }
  
  .custom-select-usuario .ant-select-selection-placeholder {
    color: rgba(255, 255, 255, 0.45) !important;
  }
  
  .custom-select-usuario .ant-select-selection-item {
    color: rgba(255, 255, 255, 0.85) !important;
  }
  
  .custom-select-usuario .ant-select-arrow {
    color: rgba(255, 255, 255, 0.45) !important;
  }
  
  .custom-select-usuario:hover .ant-select-selector {
    border-color: rgba(255, 255, 255, 0.2) !important;
  }
  
  .custom-select-usuario.ant-select-focused .ant-select-selector {
    border-color: #33F491 !important;
    box-shadow: 0 0 0 2px rgba(51, 244, 145, 0.1) !important;
  }
  
  .custom-select-dropdown {
    background-color: #2a3441 !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: 8px !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
    z-index: 1050 !important;
    position: fixed !important;
  }
  
  .custom-select-dropdown .ant-select-item {
    background-color: transparent !important;
    color: rgba(255, 255, 255, 0.85) !important;
    border-radius: 4px !important;
    margin: 2px 8px !important;
    padding: 8px 12px !important;
  }
  
  .custom-select-dropdown .ant-select-item:hover {
    background-color: rgba(255, 255, 255, 0.06) !important;
  }
  
  .custom-select-dropdown .ant-select-item-option-selected {
    background-color: #33F491 !important;
    color: #222222 !important;
  }
  
  .custom-select-dropdown .ant-select-item-option-selected:hover {
    background-color: #33F491 !important;
    color: #222222 !important;
  }

  .permissions-table .ant-table-thead > tr > th {
    padding: 12px 16px !important;
    background: rgba(255, 255, 255, 0.04) !important;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
    color: rgba(255, 255, 255, 0.85) !important;
  }

  .permissions-table .ant-table-tbody > tr > td {
    padding: 14px 16px !important;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05) !important;
    color: rgba(255, 255, 255, 0.85) !important;
  }

  .permissions-table .ant-table-tbody > tr:hover > td {
    background: rgba(255, 255, 255, 0.04) !important;
  }
`,{Title:Ue,Text:Y}=be,{TabPane:Q}=ne,$e=()=>{const{empresa:p}=ye(),[x,f]=l.useState([]),[i,d]=l.useState(null),[t,n]=l.useState(null),[c,y]=l.useState("preset"),[k,h]=l.useState("viewer"),[S,b]=l.useState(!1),[I,u]=l.useState(!1),[o,C]=l.useState(window.innerWidth>=1024),[M,U]=l.useState(!1),{message:B}=D.useApp(),O=Le(),T=["dashboard","oportunidades","propiedades","visitas","contratos","cobros","propietarios","reportes","usuarios","integraciones","agencia"];l.useEffect(()=>{const a=()=>C(window.innerWidth>=1024);return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),l.useEffect(()=>{q()},[]),l.useEffect(()=>{i&&V()},[i]);const q=async()=>{if(!(p!=null&&p.id)){console.log("No empresa ID available");return}try{b(!0);const a=await Ee(p.id);f(a)}catch(a){console.error("Error loading profiles:",a),B.error("Error al cargar perfiles")}finally{b(!1)}},V=async()=>{if(i)try{b(!0);const a=await ze(i.id);if(a)n(a),y("custom");else{const g=J(i.role);n(g),h(i.role),y("preset")}}catch{B.error("Error al cargar permisos")}finally{b(!1)}},r=a=>{h(a);const g=J(a);n(g)},s=(a,g,v)=>{if(!t)return;const E={...t,[a]:{...t[a],[g]:v}};n(E),c==="preset"&&y("custom")},m=a=>{if(!t)return;const v=!T.every($=>t[$][a]),E={...t};T.forEach($=>{E[$]={...E[$],[a]:v}}),n(E),y("custom")},w=async()=>{if(!(!i||!t))try{u(!0),await Ie(i.id,t),B.success("Permisos guardados correctamente")}catch{B.error("Error al guardar permisos")}finally{u(!1)}},A=()=>{i&&V()},R=()=>{U(!0)},F=[{title:"Módulo",dataIndex:"module",key:"module",fixed:"left",width:200,render:a=>e.jsx(Y,{strong:!0,children:O[a]})},{title:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{children:"Crear"}),e.jsx(P,{size:"small",checked:t?T.every(a=>t[a].create):!1,onChange:()=>m("create"),disabled:c==="preset"})]}),dataIndex:"create",key:"create",width:100,align:"center",render:(a,g)=>{var v;return e.jsx(P,{checked:((v=t==null?void 0:t[g.module])==null?void 0:v.create)||!1,onChange:E=>s(g.module,"create",E),disabled:c==="preset"})}},{title:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{children:"Leer"}),e.jsx(P,{size:"small",checked:t?T.every(a=>t[a].read):!1,onChange:()=>m("read"),disabled:c==="preset"})]}),dataIndex:"read",key:"read",width:100,align:"center",render:(a,g)=>{var v;return e.jsx(P,{checked:((v=t==null?void 0:t[g.module])==null?void 0:v.read)||!1,onChange:E=>s(g.module,"read",E),disabled:c==="preset"})}},{title:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{children:"Actualizar"}),e.jsx(P,{size:"small",checked:t?T.every(a=>t[a].update):!1,onChange:()=>m("update"),disabled:c==="preset"})]}),dataIndex:"update",key:"update",width:100,align:"center",render:(a,g)=>{var v;return e.jsx(P,{checked:((v=t==null?void 0:t[g.module])==null?void 0:v.update)||!1,onChange:E=>s(g.module,"update",E),disabled:c==="preset"})}},{title:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{children:"Eliminar"}),e.jsx(P,{size:"small",checked:t?T.every(a=>t[a].delete):!1,onChange:()=>m("delete"),disabled:c==="preset"})]}),dataIndex:"delete",key:"delete",width:100,align:"center",render:(a,g)=>{var v;return e.jsx(P,{checked:((v=t==null?void 0:t[g.module])==null?void 0:v.delete)||!1,onChange:E=>s(g.module,"delete",E),disabled:c==="preset"})}}],le=T.map(a=>({key:a,module:a}));return e.jsxs("div",{style:{padding:"0 16px 24px 16px"},children:[e.jsx("style",{children:De}),e.jsx("div",{className:"mb-24",children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",flexWrap:"wrap",gap:"16px",marginBottom:"24px"},children:[e.jsxs("div",{style:{flex:"1 1 auto",minWidth:"300px"},children:[e.jsx(Ue,{level:2,className:"title-text mb-0",children:"Usuarios y roles"}),e.jsx("div",{className:"paragraph-text paragraph-secondary",style:{marginTop:"8px"},children:"Asigna permisos por módulo a cada miembro de tu inmobiliaria."})]}),e.jsx(j,{type:"primary",icon:e.jsx(K,{size:16}),onClick:R,className:"agregar-propiedad-btn",children:"Invitar a un usuario"})]})}),e.jsxs("div",{className:"d-flex flex-column gap-24",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:o?"1fr 2fr":"1fr",gap:"24px"},children:[e.jsx(W,{title:"Información general",className:"modern-card",style:{height:"fit-content",overflow:"visible"},styles:{body:{padding:o?"24px":"16px",overflow:"visible"}},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:o?"16px":"12px"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"d-block font-medium mb-8",children:"Usuario"}),e.jsx(L,{placeholder:"Seleccionar usuario",loading:S,value:i==null?void 0:i.id,onChange:a=>{const g=x.find(v=>v.id===a);d(g||null)},popupMatchSelectWidth:!1,className:"w-full custom-select-usuario",getPopupContainer:()=>document.body,dropdownStyle:{zIndex:1050},children:x.map(a=>e.jsx(L.Option,{value:a.id,children:e.jsx("div",{children:e.jsx("div",{className:"font-medium",children:a.full_name})})},a.id))})]}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"d-block font-medium mb-8",children:"Nombre"}),e.jsx("div",{className:"p-12",children:i.full_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"d-block font-medium mb-8",children:"Email"}),e.jsx("div",{className:"p-12",children:i.user_id})]})]})]})}),i&&e.jsxs(W,{title:"Rol y accesos",className:"modern-card",styles:{body:{padding:o?"24px":"16px"}},children:[e.jsx("div",{style:{padding:o?"0 0 16px 0":"0 0 12px 0"},children:e.jsxs(ne,{activeKey:c,onChange:a=>y(a),style:{marginBottom:o?"24px":"16px"},children:[e.jsx(Q,{tab:"Rol predeterminado",children:e.jsx("div",{style:{marginBottom:"16px",padding:o?"16px 0":"12px 0"},children:e.jsxs(L,{value:k,onChange:r,style:{width:200},children:[e.jsx(L.Option,{value:"owner",children:"Owner"}),e.jsx(L.Option,{value:"admin",children:"Admin"}),e.jsx(L.Option,{value:"manager",children:"Manager"}),e.jsx(L.Option,{value:"agent",children:"Agente"}),e.jsx(L.Option,{value:"viewer",children:"Lector"})]})})},"preset"),e.jsx(Q,{tab:"Rol personalizado",children:e.jsx("div",{style:{marginBottom:"16px",padding:o?"16px 0":"12px 0"},children:e.jsx(Y,{style:{color:"rgba(255, 255, 255, 0.65)"},children:"Personaliza los permisos específicos para este usuario"})})},"custom")]})}),t&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:o?"24px":"16px",marginTop:"16px"},children:[e.jsx("div",{style:{overflowX:"auto",padding:o?"16px":"12px",backgroundColor:"rgba(255, 255, 255, 0.02)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:e.jsx(re,{columns:F,dataSource:le,pagination:!1,scroll:{x:600},size:"middle",style:{backgroundColor:"transparent"},className:"permissions-table"})}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",paddingTop:o?"16px":"12px",borderTop:"1px solid rgba(255, 255, 255, 0.1)",marginTop:"auto"},children:[e.jsx(j,{onClick:A,style:{backgroundColor:"transparent",borderColor:"rgba(255, 255, 255, 0.2)",color:"rgba(255, 255, 255, 0.85)",padding:o?"8px 16px":"6px 12px"},children:"Cancelar"}),e.jsx(j,{type:"primary",onClick:w,loading:I,style:{padding:o?"8px 16px":"6px 12px"},children:"Guardar"})]})]})]})]}),e.jsxs(W,{title:"Links de Invitación",className:"modern-card",style:{marginTop:"24px"},styles:{body:{padding:o?"24px":"16px"}},children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx(Y,{type:"secondary",style:{color:"rgba(255, 255, 255, 0.7)"},children:"Genera links de invitación reutilizables para que nuevos agentes se registren en tu empresa."})}),e.jsx(Me,{})]})]}),e.jsx(Ae,{visible:M,onClose:()=>U(!1)})]})};export{$e as default};

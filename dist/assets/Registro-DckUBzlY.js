import{F as r,r as u,j as e,R as m,C as t,I as s,D as T,d as q,S as p,B as y,a as A,T as $,A as M,b as P}from"./index-BmXdxNCh.js";const O="http://localhost:3000",Y=async c=>{const n=await fetch(`${O}/api/v1/prospectos`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!n.ok){const d=await n.json();throw new Error(d.message||"Error en el registro")}const l=await n.json();console.log("Usuario creado con éxito:",l)},{Title:k}=$,{Step:R}=P,B=()=>{const[c]=r.useForm(),[n,l]=u.useState(null),[d,h]=u.useState(!1),[b,I]=u.useState(0),[f,S]=u.useState("+56"),C=[{value:56,label:"+56"},{value:54,label:"+54"},{value:57,label:"+57"},{value:1,label:"+1"},{value:52,label:"+52"}],D=[{value:"masculino",label:"Masculino"},{value:"femenino",label:"Femenino"},{value:"otro",label:"Otro"}],E=[{value:"RUT",label:"RUT"},{value:"Pasaporte",label:"Pasaporte"},{value:"Otro",label:"Otro"}],N=[{value:"Empleado",label:"Empleado"},{value:"Independiente",label:"Independiente"},{value:"Desempleado",label:"Desempleado"},{value:"Estudiante",label:"Estudiante"},{value:"Pensionado",label:"Pensionado"}],w=()=>{I(0)},F=async a=>{l(null),h(!0);try{await c.validateFields(["email"]),l(null);const o={user_id:"",full_name:`${a.primerNombre} ${a.primerApellido}`,phone:`${f}${a.telefono}`};await Y(o)}catch{l("Error en el registro. Verifica los datos e intenta nuevamente.")}finally{h(!1)}},j=[{title:"Información Laboral",content:e.jsxs(e.Fragment,{children:[e.jsxs(m,{gutter:16,children:[e.jsx(t,{span:12,children:e.jsx(r.Item,{label:"Primer nombre",name:"primerNombre",rules:[{required:!0,message:"Por favor ingresa tu primer nombre"}],children:e.jsx(s,{placeholder:"Primer nombre"})})}),e.jsx(t,{span:12,children:e.jsx(r.Item,{label:"Segundo nombre",name:"segundoNombre",children:e.jsx(s,{placeholder:"Segundo nombre (opcional)"})})})]}),e.jsxs(m,{gutter:16,children:[e.jsx(t,{span:12,children:e.jsx(r.Item,{label:"Primer apellido",name:"primerApellido",rules:[{required:!0,message:"Por favor ingresa tu primer apellido"}],children:e.jsx(s,{placeholder:"Primer apellido"})})}),e.jsx(t,{span:12,children:e.jsx(r.Item,{label:"Segundo apellido",name:"segundoApellido",children:e.jsx(s,{placeholder:"Segundo apellido (opcional)"})})})]}),e.jsx(r.Item,{label:"Fecha de nacimiento",name:"fechaNacimiento",rules:[{required:!0,message:"Por favor ingresa tu fecha de nacimiento"},()=>({validator(a,o){if(!o)return Promise.resolve();const i=new Date,g=o.toDate?o.toDate():o,x=i.getFullYear()-g.getFullYear(),v=i.getMonth()-g.getMonth();return x>18||x===18&&(v>0||v===0&&i.getDate()>=g.getDate())?Promise.resolve():Promise.reject(new Error("Debes tener al menos 18 años para registrarte"))}})],children:e.jsx(T,{placeholder:"Fecha de nacimiento",format:"DD/MM/YYYY",defaultValue:q().subtract(18,"year"),className:"registro-date-picker",disabledDate:a=>{if(!a)return!1;const o=new Date,i=new Date(o.getFullYear()-18,o.getMonth(),o.getDate());return a.isAfter(i,"day")}})}),e.jsx(r.Item,{label:"Género",name:"genero",rules:[{required:!0,message:"Por favor selecciona tu género"}],children:e.jsx(p,{placeholder:"Selecciona tu género",options:D})}),e.jsx(r.Item,{label:"Tipo de identificación",name:"tipoIdNacional",rules:[{required:!0,message:"Por favor selecciona el tipo de identificación"}],children:e.jsx(p,{placeholder:"Tipo de identificación",options:E})}),e.jsx(r.Item,{label:"Número de identificación",name:"idNacional",rules:[{required:!0,message:"Por favor ingresa tu número de identificación"},{pattern:/^[0-9]+$/,message:"El número de identificación solo debe contener números"}],children:e.jsx(s,{placeholder:"Número de identificación"})}),e.jsx(r.Item,{label:"Teléfono",name:"telefono",rules:[{required:!0,message:"Por favor ingresa tu número de teléfono"},{pattern:/^[0-9]+$/,message:"El teléfono solo debe contener números"}],children:e.jsx(s,{placeholder:"Teléfono",addonBefore:e.jsx(p,{value:f,onChange:S,options:C})})}),e.jsx(r.Item,{label:"Correo electrónico",name:"email",rules:[{required:!0,message:"Por favor ingresa tu correo electrónico"},{type:"email",message:"El correo no es válido"}],children:e.jsx(s,{placeholder:"Correo electrónico",autoFocus:!0})}),e.jsx(r.Item,{label:"Situación laboral actual",name:"situacionLaboralActual",rules:[{required:!0,message:"Por favor selecciona tu género"}],children:e.jsx(p,{placeholder:"Selecciona tu situación laboral actual",options:N})}),e.jsx(r.Item,{label:"Ingresos mensuales",name:"ingresoMensual",rules:[{required:!1,message:"Por favor ingresa tu número de identificación"},{pattern:/^[0-9]+$/,message:"El número de identificación solo debe contener números"}],children:e.jsx(s,{placeholder:"Ingresos mensuales"})}),e.jsx(r.Item,{label:"Egresos mensuales",name:"egresoMensual",rules:[{required:!1,message:"Por favor ingresa tu número de identificación"},{pattern:/^[0-9]+$/,message:"El número de identificación solo debe contener números"}],children:e.jsx(s,{placeholder:"Egresos mensuales"})}),e.jsx(r.Item,{children:e.jsxs(m,{gutter:16,children:[e.jsx(t,{span:12,children:e.jsx(y,{onClick:w,block:!0,children:"Anterior"})}),e.jsx(t,{span:12,children:e.jsx(y,{type:"primary",htmlType:"submit",block:!0,loading:d,children:"Crear Cuenta"})})]})})]})}];return e.jsx(m,{justify:"center",align:"middle",className:"registro-main-row",children:e.jsx(t,{xs:24,sm:20,md:16,lg:12,xl:10,children:e.jsxs(A,{className:"registro-card",children:[e.jsx(k,{level:2,className:"title-text registro-title",children:"Crear Cuenta"}),n&&e.jsx(M,{message:n,type:"error",showIcon:!0,className:"registro-error-alert"}),e.jsx(P,{current:b,className:"registro-steps",children:j.map(a=>e.jsx(R,{title:a.title},a.title))}),e.jsx(r,{form:c,layout:"vertical",onFinish:F,autoComplete:"off",disabled:d,children:j[b].content})]})})})};export{B as default};

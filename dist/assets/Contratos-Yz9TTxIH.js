import{c as oe,be as z,j as e,S as I,aE as V,bf as _,b9 as re,a3 as P,B as f,bg as G,a as w,t as A,f as L,l as ne,r,e as le,b7 as O}from"./index-BmXdxNCh.js";import{S as ie}from"./sparkles-DOew5jng.js";import{l as ce,a as de,b as pe,u as ue,c as me}from"./contratosNewServiceMock-DGZkPxYE.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ge=oe("upload",he),xe=({propiedades:a,selectedPropiedadId:t,onSelectPropiedad:i,loading:n=!1})=>{const{getLabel:s}=z();return e.jsx("div",{className:"contracts-header",children:e.jsxs("div",{className:"contracts-header-content",children:[e.jsxs("div",{className:"contracts-header-text",children:[e.jsx("h1",{children:"Contratos"}),e.jsx("p",{children:"Gestiona tus contratos y documentos legales"})]}),e.jsxs("div",{className:"contracts-header-selector",children:[e.jsx("label",{children:s("Propiedad","Espacio")}),e.jsx(I,{value:t,onChange:i,loading:n,showSearch:!0,filterOption:(d,p)=>((p==null?void 0:p.label)??"").toLowerCase().includes(d.toLowerCase()),placeholder:s("Selecciona una propiedad","Selecciona un espacio"),className:"property-selector",options:a.map(d=>({value:d.id,label:`${d.titulo} · ${d.ciudad||""}`}))})]})]})})},fe=({contratos:a,loading:t=!1,onView:i})=>{const{activePreset:n}=V(),{getLabel:s}=z(),d=l=>{if(n==="coworking")switch(l){case"activa":return"green";case"renovacion_pendiente":return"orange";case"suspendida":return"red";case"cancelada":return"default";default:return"default"}switch(l){case"Firmado":case"firmado":return"green";case"Enviado":case"enviado":return"blue";case"Pendiente":case"pendiente":return"orange";case"anulado":return"red";default:return"default"}},p=l=>n==="coworking"&&{activa:"Activa",renovacion_pendiente:"Renovación Pendiente",suspendida:"Suspendida",cancelada:"Cancelada"}[l]||l,h=[{title:n==="coworking"?"Plan / Miembro":"Título",dataIndex:"titulo",key:"titulo",ellipsis:!0},{title:"Estado",dataIndex:"estado",key:"estado",width:180,render:l=>e.jsx(P,{color:d(l),children:p(l)})},{title:"Fecha",dataIndex:"createdAt",key:"createdAt",width:150,render:l=>new Date(l).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})},{title:"Acciones",key:"actions",width:100,render:(l,g)=>e.jsx(f,{type:"text",size:"small",icon:e.jsx(G,{size:16}),onClick:()=>i(g),children:"Ver"})}];return e.jsx("div",{className:"contracts-table-container",children:a.length===0&&!t?e.jsx(_,{description:s("No hay contratos para esta propiedad","No hay membresías para este espacio"),image:_.PRESENTED_IMAGE_SIMPLE,className:"contracts-empty-state"}):e.jsx(re,{columns:h,dataSource:a,rowKey:"id",loading:t,pagination:!1,className:"contracts-table"})})},je=({plantillas:a,onUseTemplate:t,onPreview:i})=>{const n=s=>{switch(s){case"Arriendo":return"blue";case"Compra":return"green";case"Encargo":return"purple";default:return"default"}};return e.jsx("div",{className:"templates-grid",children:a.map(s=>e.jsxs(w,{className:"template-card",children:[e.jsxs("div",{className:"template-card-header",children:[e.jsx(A,{size:24,className:"template-icon"}),e.jsx(P,{color:n(s.tipo),children:s.tipo})]}),e.jsx("h3",{className:"template-title",children:s.titulo}),e.jsxs("div",{className:"template-meta",children:[e.jsxs("span",{className:"template-date",children:["Actualizado: ",new Date(s.updatedAt).toLocaleDateString("es-ES")]}),s.source==="upload"&&e.jsx(P,{color:"orange",children:"Importado"})]}),e.jsxs("div",{className:"template-actions",children:[e.jsx(f,{type:"text",icon:e.jsx(G,{size:16}),onClick:()=>i(s),children:"Vista previa"}),e.jsx(f,{type:"primary",onClick:()=>t(s),children:"Usar plantilla"})]})]},s.id))})},Ne=({onFileSelect:a})=>{const{message:t}=L.useApp(),i=n=>n.type==="application/pdf"||n.type==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"||n.type==="application/msword"?(n.size||0)/1024/1024<10?(a(n),!1):(t.error("El archivo debe ser menor a 10MB"),!1):(t.error("Solo se permiten archivos PDF o DOCX"),!1);return e.jsx("div",{className:"upload-dropzone-container",children:e.jsx(ne.Dragger,{name:"file",multiple:!1,beforeUpload:i,showUploadList:!1,className:"contract-upload-dragger",children:e.jsxs("div",{className:"upload-dropzone-content",children:[e.jsx(ge,{size:48,className:"upload-icon"}),e.jsx("h3",{children:"Importa tu contrato"}),e.jsx("p",{children:"Arrastra un archivo .docx o .pdf aquí"}),e.jsx("p",{className:"upload-hint",children:"o haz clic para seleccionar"})]})})})},ve=({fileName:a,onMakeEditable:t,loading:i=!1})=>e.jsxs(w,{className:"upload-card",children:[e.jsxs("div",{className:"upload-card-content",children:[e.jsx(A,{size:48,className:"upload-card-icon"}),e.jsxs("div",{className:"upload-card-info",children:[e.jsx("h3",{children:a}),e.jsx("p",{children:"Archivo cargado correctamente"})]})]}),e.jsx(f,{type:"primary",icon:e.jsx(ie,{size:16}),onClick:t,loading:i,size:"large",children:"Volver modificable"})]}),Ce=({plantillas:a,uploadedFile:t,onUseTemplate:i,onPreviewTemplate:n,onFileSelect:s,onMakeEditable:d,makeEditableLoading:p=!1})=>e.jsxs("div",{className:"create-section",children:[e.jsx("h2",{className:"section-title",children:"Crea tu propio contrato"}),e.jsxs("div",{className:"templates-grid-container",children:[e.jsx(je,{plantillas:a,onUseTemplate:i,onPreview:n}),e.jsx(w,{className:"template-card upload-template-card",children:e.jsxs("div",{className:"upload-card-content",children:[e.jsx("h3",{className:"upload-title",children:"Importa tus propios documentos"}),t?e.jsx(ve,{fileName:t.name,onMakeEditable:d,loading:p}):e.jsx(Ne,{onFileSelect:s})]})})]})]}),Ee=({plantilla:a,propiedades:t,prospectos:i,selectedPropiedadId:n,onGenerate:s,onCancel:d,loading:p=!1})=>{const{message:h}=L.useApp(),[l,g]=r.useState(n),[u,C]=r.useState(null),j=()=>{if(!l){h.warning("Selecciona una propiedad");return}if(!u){h.warning("Selecciona un prospecto");return}s(l,u)};return e.jsxs("div",{className:"generate-form",children:[e.jsx("div",{className:"generate-form-header",children:e.jsxs("p",{className:"plantilla-name",children:["Plantilla: ",a.titulo]})}),e.jsxs("div",{className:"generate-form-fields",children:[e.jsxs("div",{className:"form-field",children:[e.jsx("label",{children:"Propiedad"}),e.jsx(I,{value:l,onChange:g,showSearch:!0,filterOption:(c,m)=>((m==null?void 0:m.label)??"").toLowerCase().includes(c.toLowerCase()),placeholder:"Selecciona una propiedad",className:"w-full",options:t.map(c=>({value:c.id,label:`${c.titulo} · ${c.ciudad}`}))})]}),e.jsxs("div",{className:"form-field",children:[e.jsx("label",{children:"Prospecto"}),e.jsx(I,{value:u,onChange:C,showSearch:!0,filterOption:(c,m)=>((m==null?void 0:m.label)??"").toLowerCase().includes(c.toLowerCase()),placeholder:"Selecciona un prospecto",className:"w-full",options:i.map(c=>({value:c.id,label:`${c.nombre} · ${c.email||c.telefono}`}))})]})]}),e.jsxs("div",{className:"generate-form-actions",children:[e.jsx(f,{onClick:d,children:"Cancelar"}),e.jsx(f,{type:"primary",icon:e.jsx(A,{size:16}),onClick:j,loading:p,disabled:!l||!u,children:"Generar borrador"})]})]})},Se=[{id:"plt-cowork-1",titulo:"Contrato Membresía Mensual",tipo:"Otro",html:`<div style="font-family: 'Poppins', sans-serif; padding: 40px; max-width: 800px; margin: 0 auto;">
      <h1 style="text-align: center; margin-bottom: 30px;">CONTRATO DE MEMBRESÍA COWORKING</h1>
      <p><strong>OPERADOR:</strong> {{empresa.nombre}}</p>
      <p><strong>MIEMBRO:</strong> {{prospecto.nombre}}, identificado con email {{prospecto.email}}</p>
      <p><strong>ESPACIO:</strong> {{propiedad.titulo}}</p>
      <p><strong>PLAN:</strong> Membresía Mensual</p>
      <p><strong>PRECIO MENSUAL:</strong> {{propiedad.moneda}} {{propiedad.canon_mensual}}</p>
      <p><strong>DÍA DE PAGO:</strong> {{propiedad.dia_pago}} de cada mes</p>
      <p><strong>FECHA:</strong> {{fecha.hoy}}</p>
      <h2>SERVICIOS INCLUIDOS</h2>
      <ul>
        <li>Acceso a escritorio compartido (Hot Desk)</li>
        <li>WiFi de alta velocidad</li>
        <li>Café ilimitado</li>
        <li>Uso de salas de reunión (según disponibilidad)</li>
        <li>Acceso a espacios comunes</li>
      </ul>
      <h2>TÉRMINOS Y CONDICIONES</h2>
      <p>El presente contrato se celebra para el uso de espacios de coworking ubicados en {{propiedad.direccion}}. El miembro se compromete a respetar las normas de convivencia y hacer uso responsable de las instalaciones.</p>
    </div>`,updatedAt:"2025-01-30",source:"auto"},{id:"plt-cowork-2",titulo:"Contrato Escritorio Flexible",tipo:"Otro",html:`<div style="font-family: 'Poppins', sans-serif; padding: 40px; max-width: 800px; margin: 0 auto;">
      <h1 style="text-align: center; margin-bottom: 30px;">CONTRATO ESCRITORIO FLEXIBLE</h1>
      <p><strong>OPERADOR:</strong> {{empresa.nombre}}</p>
      <p><strong>MIEMBRO:</strong> {{prospecto.nombre}}</p>
      <p><strong>EMAIL:</strong> {{prospecto.email}}</p>
      <p><strong>TELÉFONO:</strong> {{prospecto.telefono}}</p>
      <p><strong>PLAN:</strong> Escritorio Flexible - 8 días al mes</p>
      <p><strong>PRECIO MENSUAL:</strong> {{propiedad.moneda}} {{propiedad.canon_mensual}}</p>
      <p><strong>FECHA:</strong> {{fecha.hoy}}</p>
      <h2>DESCRIPCIÓN DEL PLAN</h2>
      <p>El plan de Escritorio Flexible permite al miembro acceso a las instalaciones hasta 8 días por mes calendario. Los días no son acumulables y deben ser reservados con al menos 24 horas de anticipación.</p>
      <h2>SERVICIOS INCLUIDOS</h2>
      <ul>
        <li>8 días de acceso por mes</li>
        <li>WiFi de alta velocidad</li>
        <li>Café y té ilimitado</li>
        <li>2 horas de sala de reunión incluidas</li>
      </ul>
    </div>`,updatedAt:"2025-01-30",source:"auto"},{id:"plt-cowork-3",titulo:"Contrato Oficina Virtual",tipo:"Otro",html:`<div style="font-family: 'Poppins', sans-serif; padding: 40px; max-width: 800px; margin: 0 auto;">
      <h1 style="text-align: center; margin-bottom: 30px;">CONTRATO OFICINA VIRTUAL</h1>
      <p><strong>OPERADOR:</strong> {{empresa.nombre}}</p>
      <p><strong>CLIENTE:</strong> {{prospecto.nombre}}</p>
      <p><strong>DIRECCIÓN PROPORCIONADA:</strong> {{propiedad.direccion}}, {{propiedad.ciudad}}</p>
      <p><strong>PRECIO MENSUAL:</strong> {{propiedad.moneda}} {{propiedad.canon_mensual}}</p>
      <p><strong>FECHA:</strong> {{fecha.hoy}}</p>
      <h2>SERVICIOS INCLUIDOS</h2>
      <ul>
        <li>Dirección comercial y tributaria</li>
        <li>Recepción de correspondencia</li>
        <li>Notificación de documentos recibidos</li>
        <li>10 horas mensuales de sala de reunión</li>
        <li>Atención telefónica personalizada (opcional)</li>
      </ul>
      <h2>OBJETO DEL CONTRATO</h2>
      <p>El operador proporciona al cliente una dirección comercial/tributaria oficial, así como servicios de recepción de correspondencia y acceso a salas de reunión según disponibilidad.</p>
    </div>`,updatedAt:"2025-01-30",source:"auto"}],be=async()=>{const{activePreset:a}=V.getState();return a==="coworking"?(await new Promise(t=>setTimeout(t,300)),Se):ce()},Ie=()=>{const{message:a}=L.useApp(),t=le(),[i,n]=r.useState([]),[s,d]=r.useState([]),[p,h]=r.useState([]),[l,g]=r.useState([]),[u,C]=r.useState(null),[j,c]=r.useState(null),[m,M]=r.useState(!1),[E,S]=r.useState(null),[$,b]=r.useState(!1),[B,T]=r.useState(!1),[N,H]=r.useState(null),[K,R]=r.useState(!1),[v,W]=r.useState(null),[q,k]=r.useState(!1),[X,D]=r.useState(!1),[J,F]=r.useState(!1);r.useEffect(()=>{Y()},[]),r.useEffect(()=>{u?U():g([])},[u]);const Y=async()=>{D(!0);try{const[o,x,y]=await Promise.all([de(),pe(),be()]);n(o),d(x),h(y),o.length>0&&C(o[0].id)}catch{a.error("Error al cargar datos")}finally{D(!1)}},U=async o=>{F(!0);try{g([])}catch{a.error("Error al cargar contratos")}finally{F(!1)}},Q=o=>{c(o)},Z=async()=>{if(j){M(!0);try{const o=await ue(j);h([...p,o]),a.success(`Plantilla "${o.titulo}" creada exitosamente`),c(null)}catch{a.error("Error al convertir el archivo")}finally{M(!1)}}},ee=o=>{S(o),b(!0)},ae=o=>{H(o),R(!0)},se=async(o,x)=>{if(E){T(!0);try{const y=await me(E.id,o,x);a.success("Borrador creado exitosamente"),b(!1),S(null),t(`/contratos/crear?contratoId=${y.id}&propiedadId=${o}&prospectoId=${x}`),u&&U(u)}catch{a.error("Error al generar el contrato")}finally{T(!1)}}},te=o=>{W(o),k(!0)};return e.jsxs("div",{className:"contratos-container",children:[e.jsx(xe,{propiedades:i,selectedPropiedadId:u,onSelectPropiedad:C,loading:X}),u&&e.jsxs(w,{className:"contracts-section-card",children:[e.jsx("h2",{children:"Mis contratos"}),e.jsx(fe,{contratos:l,loading:J,onView:te})]}),e.jsx(Ce,{plantillas:p,uploadedFile:j,onUseTemplate:ee,onPreviewTemplate:ae,onFileSelect:Q,onMakeEditable:Z,makeEditableLoading:m}),e.jsx(O,{title:"Generar contrato",open:$,onCancel:()=>{b(!1),S(null)},footer:null,width:600,className:"generate-form-modal",children:E&&e.jsx(Ee,{plantilla:E,propiedades:i,prospectos:s,selectedPropiedadId:u,onGenerate:se,onCancel:()=>{b(!1),S(null)},loading:B})}),e.jsx(O,{title:`Vista previa: ${N==null?void 0:N.titulo}`,open:K,onCancel:()=>R(!1),footer:null,width:800,className:"template-preview-modal",children:N&&e.jsx("div",{className:"template-preview-content",dangerouslySetInnerHTML:{__html:N.html}})}),e.jsx(O,{title:`Contrato: ${v==null?void 0:v.titulo}`,open:q,onCancel:()=>k(!1),footer:null,width:800,className:"contract-view-modal",children:v&&e.jsx("div",{className:"contract-view-content",dangerouslySetInnerHTML:{__html:v.html}})})]})};export{Ie as default};
